<h1 id="map-reduce">Map-Reduce</h1>
<pre><span class=hs-linenum>5: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>MapReduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>mapReduce</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>6: </span>
<span class=hs-linenum>7: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<span class=hs-linenum>8: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>List</span>
<span class=hs-linenum>9: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span><span class='hs-layout'>,</span> <span class='hs-varid'>reduce</span><span class='hs-layout'>,</span> <span class='hs-varid'>concat</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>10: </span><span class='hs-definition'>expand</span>   <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>11: </span><span class='hs-definition'>group</span>    <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>12: </span><span class='hs-definition'>collapse</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span>
</pre>
<p>The following is a super simplified implementation of <a href="http://en.wikipedia.org/wiki/MapReduce">Map-Reduce</a> using the <a href="List.lhs">Lists</a> and <code>Data.Map</code>.</p>
<pre><span class=hs-linenum>20: </span><span class='hs-definition'>mapReduce</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>21: </span>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>22: </span>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>23: </span>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span>
<span class=hs-linenum>24: </span>
<span class=hs-linenum>25: </span><a class=annot href="#"><span class=annottext>(GHC.Classes.Ord k) =&gt;
lq_tmp_x_1064:(lq_tmp_x_1060:a -&gt; (List.List (k, v))) -&gt; lq_tmp_x_1065:(lq_tmp_x_1061:v -&gt; lq_tmp_x_1062:v -&gt; v) -&gt; lq_tmp_x_1066:(List.List a) -&gt; (Data.Map.Base.Map k v)</span><span class='hs-definition'>mapReduce</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1060:a -&gt; (List.List (k, v))</span><span class='hs-varid'>fm</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1061:v -&gt; lq_tmp_x_1062:v -&gt; v</span><span class='hs-varid'>fr</span></a> <a class=annot href="#"><span class=annottext>(List.List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1145 : (Data.Map.Base.Map {VV#1135 : k^"lq_tmp_x_1137" | $k__1136[lq_tmp_x_1130:=fr#a1K4][lq_tmp_x_1131:=kvsm#a1K7][lq_tmp_x_1125:=lq_tmp_x_1145]} {VV#1132 : v^"lq_tmp_x_1134" | $k__1133[lq_tmp_x_1130:=fr#a1K4][lq_tmp_x_1131:=kvsm#a1K7][lq_tmp_x_1125:=lq_tmp_x_1145]}) | lq_tmp_x_1145 == kvm#a1K8}</span><span class='hs-varid'>kvm</span></a>
<span class=hs-linenum>26: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>27: </span>    <a class=annot href="#"><span class=annottext>(List.List ({VV#1087 : k^"lq_tmp_x_1089" | $k__1088[lq_tmp_x_1082:=fm#a1K3][lq_tmp_x_1083:=xs#a1K5]}, {VV#1090 : v^"lq_tmp_x_1092" | $k__1091[lq_tmp_x_1082:=fm#a1K3][lq_tmp_x_1083:=xs#a1K5]}))</span><span class='hs-varid'>kvs</span></a>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1083:(List.List {VV#1084 : a^"lq_tmp_x_1086" | $k__1085[lq_tmp_x_1082:=fm#a1K3]}) -&gt; (List.List ({VV#1087 : k^"lq_tmp_x_1089" | $k__1088[lq_tmp_x_1082:=fm#a1K3]}, {VV#1090 : v^"lq_tmp_x_1092" | $k__1091[lq_tmp_x_1082:=fm#a1K3]}))</span><span class='hs-varid'>expand</span></a>      <a class=annot href="#"><span class=annottext>lq_tmp_x_1097:a -&gt; (List.List (k, v))</span><span class='hs-varid'>fm</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1098 : (List.List a)^"lq_tmp_x_314" | lq_tmp_x_1098 == xs#a1K5}</span><span class='hs-varid'>xs</span></a>     <span class='hs-comment'>-- step 1</span>
<span class=hs-linenum>28: </span>    <a class=annot href="#"><span class=annottext>(Data.Map.Base.Map {VV#1110 : k^"lq_tmp_x_1112" | $k__1111[lq_tmp_x_1108:=fix##36#dOrd_a1MZ][lq_tmp_x_1109:=kvs#a1K6]} {lq_tmp_x_1104 : (List.List {VV#1113 : v^"lq_tmp_x_1115" | $k__1114[lq_tmp_x_1108:=fix##36#dOrd_a1MZ][lq_tmp_x_1109:=kvs#a1K6]}) | size lq_tmp_x_1104 &gt; 0})</span><span class='hs-varid'>kvsm</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1109:(List.List ({VV#1110 : k^"lq_tmp_x_1112" | $k__1111[lq_tmp_x_1108:=fix##36#dOrd_a1MZ]}, {VV#1113 : v^"lq_tmp_x_1115" | $k__1114[lq_tmp_x_1108:=fix##36#dOrd_a1MZ]})) -&gt; (Data.Map.Base.Map {VV#1110 : k^"lq_tmp_x_1112" | $k__1111[lq_tmp_x_1108:=fix##36#dOrd_a1MZ]} {lq_tmp_x_1104 : (List.List {VV#1113 : v^"lq_tmp_x_1115" | $k__1114[lq_tmp_x_1108:=fix##36#dOrd_a1MZ]}) | size lq_tmp_x_1104 &gt; 0})</span><span class='hs-varid'>group</span></a>       <a class=annot href="#"><span class=annottext>{lq_tmp_x_1119 : (List.List ({VV#1087 : k^"lq_tmp_x_1089" | $k__1088[lq_tmp_x_1082:=fm#a1K3][lq_tmp_x_1083:=xs#a1K5][lq_tmp_x_1077:=lq_tmp_x_1118][lq_tmp_x_1078:=lq_tmp_x_1119]}, {VV#1090 : v^"lq_tmp_x_1092" | $k__1091[lq_tmp_x_1082:=fm#a1K3][lq_tmp_x_1083:=xs#a1K5][lq_tmp_x_1077:=lq_tmp_x_1118][lq_tmp_x_1078:=lq_tmp_x_1119]})) | lq_tmp_x_1119 == kvs#a1K6}</span><span class='hs-varid'>kvs</span></a>       <span class='hs-comment'>-- step 2</span>
<span class=hs-linenum>29: </span>    <a class=annot href="#"><span class=annottext>(Data.Map.Base.Map {VV#1135 : k^"lq_tmp_x_1137" | $k__1136[lq_tmp_x_1130:=fr#a1K4][lq_tmp_x_1131:=kvsm#a1K7]} {VV#1132 : v^"lq_tmp_x_1134" | $k__1133[lq_tmp_x_1130:=fr#a1K4][lq_tmp_x_1131:=kvsm#a1K7]})</span><span class='hs-varid'>kvm</span></a>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1131:(Data.Map.Base.Map {VV#1135 : k^"lq_tmp_x_1137" | $k__1136[lq_tmp_x_1130:=fr#a1K4]} {lq_tmp_x_1123 : (List.List {VV#1132 : v^"lq_tmp_x_1134" | $k__1133[lq_tmp_x_1130:=fr#a1K4]}) | size lq_tmp_x_1123 &gt; 0}) -&gt; (Data.Map.Base.Map {VV#1135 : k^"lq_tmp_x_1137" | $k__1136[lq_tmp_x_1130:=fr#a1K4]} {VV#1132 : v^"lq_tmp_x_1134" | $k__1133[lq_tmp_x_1130:=fr#a1K4]})</span><span class='hs-varid'>collapse</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1140:v -&gt; lq_tmp_x_1141:v -&gt; v</span><span class='hs-varid'>fr</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1143 : (Data.Map.Base.Map {VV#1110 : k^"lq_tmp_x_1112" | $k__1111[lq_tmp_x_1108:=fix##36#dOrd_a1MZ][lq_tmp_x_1109:=kvs#a1K6][lq_tmp_x_1105:=lq_tmp_x_1143]} {lq_tmp_x_1142 : (List.List {VV#1113 : v^"lq_tmp_x_1115" | $k__1114[lq_tmp_x_1108:=fix##36#dOrd_a1MZ][lq_tmp_x_1109:=kvs#a1K6][lq_tmp_x_1104:=lq_tmp_x_1142][lq_tmp_x_1105:=lq_tmp_x_1143]}) | size lq_tmp_x_1142 &gt; 0}) | lq_tmp_x_1143 == kvsm#a1K7}</span><span class='hs-varid'>kvsm</span></a>      <span class='hs-comment'>-- step 3</span>
</pre>
<p><strong>The Problem</strong> If you solved <code>foldr1</code> then you should get a single type error below, in the call to <code>foldr1</code> in <code>collapse</code>. Fix the error by <strong>modifying the refinement type specifications</strong> only (do not modify any code).</p>
<p><strong>Note:</strong> This problem requires you to have solved the <code>foldr1</code> problem from <a href="List.lhs" class="uri">List.lhs</a>; otherwise no points.</p>
<p>Next, we briefly describe and show each step of the <code>mapReduce</code> function.</p>
<h2 id="step-1-map-elements-into-key-value-lists">Step 1: Map Elements into Key-Value Lists</h2>
<pre><span class=hs-linenum>48: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>expand</span>  <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>49: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_994:(lq_tmp_x_993:a -&gt; (List.List (k, v))) -&gt; lq_tmp_x_995:(List.List a) -&gt; (List.List (k, v))</span><span class='hs-definition'>expand</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_993:a -&gt; (List.List (k, v))</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>(List.List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>concat</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1058 : (List.List {lq_tmp_x_1057 : (List.List {lq_tmp_x_1056 : ({VV#1009 : k^"lq_tmp_x_1011" | $k__1010[VV#1019:=lq_tmp_x_1056][VV#1022:=lq_tmp_x_1057][lq_tmp_x_1004:=f#a1K9][lq_tmp_x_1005:=xs#a1Ka][lq_tmp_x_1026:=lq_tmp_x_1056][lq_tmp_x_1027:=lq_tmp_x_1057][lq_tmp_x_1000:=lq_tmp_x_1058]}, {VV#1012 : v^"lq_tmp_x_1014" | $k__1013[VV#1019:=lq_tmp_x_1056][VV#1022:=lq_tmp_x_1057][lq_tmp_x_1004:=f#a1K9][lq_tmp_x_1005:=xs#a1Ka][lq_tmp_x_1026:=lq_tmp_x_1056][lq_tmp_x_1027:=lq_tmp_x_1057][lq_tmp_x_1000:=lq_tmp_x_1058]})^"lq_tmp_x_1021" | $k__1020[VV#1019:=lq_tmp_x_1056][VV#1022:=lq_tmp_x_1057][lq_tmp_x_1004:=f#a1K9][lq_tmp_x_1005:=xs#a1Ka][lq_tmp_x_1026:=lq_tmp_x_1056][lq_tmp_x_1027:=lq_tmp_x_1057][lq_tmp_x_1000:=lq_tmp_x_1058]})^"lq_tmp_x_1024" | $k__1023[VV#1022:=lq_tmp_x_1057][lq_tmp_x_1004:=f#a1K9][lq_tmp_x_1005:=xs#a1Ka][lq_tmp_x_1027:=lq_tmp_x_1057][lq_tmp_x_1000:=lq_tmp_x_1058]}) | lq_tmp_x_1058 == lq_anf__d1O3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1005:(List.List {VV#1006 : a^"lq_tmp_x_1008" | $k__1007[lq_tmp_x_1004:=f#a1K9]}) -&gt; {lq_tmp_x_1000 : (List.List {lq_tmp_x_1027 : (List.List {lq_tmp_x_1026 : ({VV#1009 : k^"lq_tmp_x_1011" | $k__1010[VV#1019:=lq_tmp_x_1026][VV#1022:=lq_tmp_x_1027][lq_tmp_x_1004:=f#a1K9]}, {VV#1012 : v^"lq_tmp_x_1014" | $k__1013[VV#1019:=lq_tmp_x_1026][VV#1022:=lq_tmp_x_1027][lq_tmp_x_1004:=f#a1K9]})^"lq_tmp_x_1021" | $k__1020[VV#1019:=lq_tmp_x_1026][VV#1022:=lq_tmp_x_1027][lq_tmp_x_1004:=f#a1K9]})^"lq_tmp_x_1024" | $k__1023[VV#1022:=lq_tmp_x_1027][lq_tmp_x_1004:=f#a1K9]}) | size lq_tmp_x_1000 == size lq_tmp_x_1005}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1032:a -&gt; (List.List (k, v))</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1033 : (List.List a) | lq_tmp_x_1033 == xs#a1Ka}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
</pre>
<h2 id="step-2-group-by-key">Step 2: Group By Key</h2>
<pre><span class=hs-linenum>56: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>group</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-keyword'>{l:</span><span class='hs-conid'>List</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>| size(l)&gt;0}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>57: </span><a class=annot href="#"><span class=annottext>(GHC.Classes.Ord k) =&gt;
lq_tmp_x_905:(List.List (k, v)) -&gt; (Data.Map.Base.Map k {l : (List.List v) | size l &gt; 0})</span><span class='hs-definition'>group</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_949:{lq_tmp_x_979 : (Data.Map.Base.Map {VV#966 : k^"lq_tmp_x_968" | $k__967[VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]} {lq_tmp_x_978 : (List.List {VV#969 : v^"lq_tmp_x_971" | $k__970[VV#972:=lq_tmp_x_978][VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]})^"lq_tmp_x_974" | $k__973[VV#972:=lq_tmp_x_978][VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]})^"lq_tmp_x_977" "lq_tmp_x_43" | $k__976[VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]} -&gt; lq_tmp_x_950:(List.List {lq_tmp_x_965 : ({VV#951 : k^"lq_tmp_x_953" | $k__952[VV#961:=lq_tmp_x_965][lq_tmp_x_948:=lq_anf__d1O1]}, {VV#954 : v^"lq_tmp_x_956" | $k__955[VV#961:=lq_tmp_x_965][lq_tmp_x_948:=lq_anf__d1O1]})^"lq_tmp_x_963" "lq_tmp_x_45" | $k__962[VV#961:=lq_tmp_x_965][lq_tmp_x_948:=lq_anf__d1O1]}) -&gt; {lq_tmp_x_979 : (Data.Map.Base.Map {VV#966 : k^"lq_tmp_x_968" | $k__967[VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]} {lq_tmp_x_978 : (List.List {VV#969 : v^"lq_tmp_x_971" | $k__970[VV#972:=lq_tmp_x_978][VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]})^"lq_tmp_x_974" | $k__973[VV#972:=lq_tmp_x_978][VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]})^"lq_tmp_x_977" "lq_tmp_x_47" | $k__976[VV#975:=lq_tmp_x_979][lq_tmp_x_948:=lq_anf__d1O1]}</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_988:{lq_tmp_x_981 : ({VV#923 : k^"lq_tmp_x_925" "lq_tmp_x_781" | $k__924[lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_909:=lq_tmp_x_981] &amp;&amp; $k__780[VV#789:=lq_tmp_x_981][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][VV#779:=VV#923][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_909:=lq_tmp_x_981]}, {VV#920 : v^"lq_tmp_x_922" "lq_tmp_x_784" | $k__921[lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_909:=lq_tmp_x_981] &amp;&amp; $k__783[VV#789:=lq_tmp_x_981][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][VV#782:=VV#920][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_909:=lq_tmp_x_981]})^"lq_tmp_x_791" | $k__790[VV#789:=lq_tmp_x_981][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_909:=lq_tmp_x_981]} -&gt; lq_tmp_x_989:{lq_tmp_x_983 : (Data.Map.Base.Map {VV#923 : k^"lq_tmp_x_925" "lq_tmp_x_795" | $k__924[lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_911:=lq_tmp_x_983][lq_tmp_x_918:=lq_tmp_x_988] &amp;&amp; $k__794[VV#802:=lq_tmp_x_983][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][VV#793:=VV#923][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_911:=lq_tmp_x_983][lq_tmp_x_918:=lq_tmp_x_988]} {lq_tmp_x_982 : (List.List {VV#920 : v^"lq_tmp_x_922" "lq_tmp_x_798" | $k__921[lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_910:=lq_tmp_x_982][lq_tmp_x_911:=lq_tmp_x_983][lq_tmp_x_918:=lq_tmp_x_988] &amp;&amp; $k__797[VV#799:=lq_tmp_x_982][VV#802:=lq_tmp_x_983][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][VV#796:=VV#920][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_910:=lq_tmp_x_982][lq_tmp_x_911:=lq_tmp_x_983][lq_tmp_x_918:=lq_tmp_x_988]})^"lq_tmp_x_801" | $k__800[VV#799:=lq_tmp_x_982][VV#802:=lq_tmp_x_983][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_910:=lq_tmp_x_982][lq_tmp_x_911:=lq_tmp_x_983][lq_tmp_x_918:=lq_tmp_x_988]})^"lq_tmp_x_804" | $k__803[VV#802:=lq_tmp_x_983][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_911:=lq_tmp_x_983][lq_tmp_x_918:=lq_tmp_x_988]} -&gt; {lq_tmp_x_985 : (Data.Map.Base.Map {VV#923 : k^"lq_tmp_x_925" "lq_tmp_x_808" | $k__924[lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_913:=lq_tmp_x_985][lq_tmp_x_918:=lq_tmp_x_988][lq_tmp_x_919:=lq_tmp_x_989] &amp;&amp; $k__807[VV#815:=lq_tmp_x_985][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][m#a1Kd:=lq_tmp_x_989][VV#806:=VV#923][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_913:=lq_tmp_x_985][lq_tmp_x_918:=lq_tmp_x_988][lq_tmp_x_919:=lq_tmp_x_989]} {lq_tmp_x_984 : (List.List {VV#920 : v^"lq_tmp_x_922" "lq_tmp_x_811" | $k__921[lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_912:=lq_tmp_x_984][lq_tmp_x_913:=lq_tmp_x_985][lq_tmp_x_918:=lq_tmp_x_988][lq_tmp_x_919:=lq_tmp_x_989] &amp;&amp; $k__810[VV#812:=lq_tmp_x_984][VV#815:=lq_tmp_x_985][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][m#a1Kd:=lq_tmp_x_989][VV#809:=VV#920][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_912:=lq_tmp_x_984][lq_tmp_x_913:=lq_tmp_x_985][lq_tmp_x_918:=lq_tmp_x_988][lq_tmp_x_919:=lq_tmp_x_989]})^"lq_tmp_x_814" | $k__813[VV#812:=lq_tmp_x_984][VV#815:=lq_tmp_x_985][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][m#a1Kd:=lq_tmp_x_989][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_912:=lq_tmp_x_984][lq_tmp_x_913:=lq_tmp_x_985][lq_tmp_x_918:=lq_tmp_x_988][lq_tmp_x_919:=lq_tmp_x_989]})^"lq_tmp_x_817" | $k__816[VV#815:=lq_tmp_x_985][fix##36#dOrd_a1My:=fix##36#dOrd_a1MG][ds_d1NO:=lq_tmp_x_988][m#a1Kd:=lq_tmp_x_989][lq_tmp_x_917:=fix##36#dOrd_a1MG][lq_tmp_x_913:=lq_tmp_x_985][lq_tmp_x_918:=lq_tmp_x_988][lq_tmp_x_919:=lq_tmp_x_989]}</span><span class='hs-varid'>addKV</span></a>  <a class=annot href="#"><span class=annottext>(Data.Map.Base.Map k a)</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>empty</span>
<span class=hs-linenum>58: </span>
<span class=hs-linenum>59: </span><a class=annot href="#"><span class=annottext>(GHC.Classes.Ord k) =&gt;
ds_d1NO:{VV#789 : ({VV#779 : k^"lq_tmp_x_781" | $k__780}, {VV#782 : t^"lq_tmp_x_784" | $k__783})^"lq_tmp_x_791" | $k__790} -&gt; m#a1Kd:{VV#802 : (Data.Map.Base.Map {VV#793 : k^"lq_tmp_x_795" | $k__794} {VV#799 : (List.List {VV#796 : t^"lq_tmp_x_798" | $k__797})^"lq_tmp_x_801" | $k__800})^"lq_tmp_x_804" | $k__803} -&gt; {VV#815 : (Data.Map.Base.Map {VV#806 : k^"lq_tmp_x_808" | $k__807} {VV#812 : (List.List {VV#809 : t^"lq_tmp_x_811" | $k__810})^"lq_tmp_x_814" | $k__813})^"lq_tmp_x_817" | $k__816}</span><span class='hs-definition'>addKV</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span><span class='hs-varid'>v</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV#802 : (Data.Map.Base.Map {VV#793 : k^"lq_tmp_x_795" | $k__794} {VV#799 : (List.List {VV#796 : t^"lq_tmp_x_798" | $k__797})^"lq_tmp_x_801" | $k__800})^"lq_tmp_x_804" | $k__803}</span><span class='hs-varid'>m</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_886:{VV#889 : k^"lq_tmp_x_891" "lq_tmp_x_68" | $k__890[lq_tmp_x_885:=fix##36#dOrd_a1My]} -&gt; lq_tmp_x_887:{lq_tmp_x_898 : (List.List {VV#892 : t^"lq_tmp_x_894" | $k__893[VV#895:=lq_tmp_x_898][lq_tmp_x_885:=fix##36#dOrd_a1My]})^"lq_tmp_x_897" "lq_tmp_x_70" | $k__896[VV#895:=lq_tmp_x_898][lq_tmp_x_885:=fix##36#dOrd_a1My]} -&gt; lq_tmp_x_888:(Data.Map.Base.Map {VV#889 : k^"lq_tmp_x_891" "lq_tmp_x_72" | $k__890[lq_tmp_x_885:=fix##36#dOrd_a1My]} {lq_tmp_x_898 : (List.List {VV#892 : t^"lq_tmp_x_894" | $k__893[VV#895:=lq_tmp_x_898][lq_tmp_x_885:=fix##36#dOrd_a1My]})^"lq_tmp_x_897" "lq_tmp_x_73" | $k__896[VV#895:=lq_tmp_x_898][lq_tmp_x_885:=fix##36#dOrd_a1My]}) -&gt; (Data.Map.Base.Map {VV#889 : k^"lq_tmp_x_891" "lq_tmp_x_75" | $k__890[lq_tmp_x_885:=fix##36#dOrd_a1My]} {lq_tmp_x_898 : (List.List {VV#892 : t^"lq_tmp_x_894" | $k__893[VV#895:=lq_tmp_x_898][lq_tmp_x_885:=fix##36#dOrd_a1My]})^"lq_tmp_x_897" "lq_tmp_x_76" | $k__896[VV#895:=lq_tmp_x_898][lq_tmp_x_885:=fix##36#dOrd_a1My]})</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <a class=annot href="#"><span class=annottext>{VV#779 : k^"lq_tmp_x_781" | VV#779 == k#a1Kb}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_900 : (List.List {VV#873 : t^"lq_tmp_x_875" | $k__874[lq_tmp_x_871:=v#a1Kc][lq_tmp_x_872:=lq_anf__d1O0][lq_tmp_x_868:=lq_tmp_x_900]}) | lq_tmp_x_900 == vs'#a1Ke}</span><span class='hs-varid'>vs'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_902 : (Data.Map.Base.Map {VV#793 : k^"lq_tmp_x_795" | $k__794[VV#802:=lq_tmp_x_902]} {lq_tmp_x_901 : (List.List {VV#796 : t^"lq_tmp_x_798" | $k__797[VV#799:=lq_tmp_x_901][VV#802:=lq_tmp_x_902]})^"lq_tmp_x_801" | $k__800[VV#799:=lq_tmp_x_901][VV#802:=lq_tmp_x_902]})^"lq_tmp_x_804" | lq_tmp_x_902 == m#a1Kd}</span><span class='hs-varid'>m</span></a>
<span class=hs-linenum>60: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>61: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_868 : (List.List {VV#873 : t^"lq_tmp_x_875" | $k__874[lq_tmp_x_871:=v#a1Kc][lq_tmp_x_872:=lq_anf__d1O0]}) | size lq_tmp_x_868 == 1 + size lq_anf__d1O0}</span><span class='hs-varid'>vs'</span></a>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_872:(List.List {VV#873 : t^"lq_tmp_x_875" | $k__874[lq_tmp_x_871:=v#a1Kc]}) -&gt; {lq_tmp_x_868 : (List.List {VV#873 : t^"lq_tmp_x_875" | $k__874[lq_tmp_x_871:=v#a1Kc]}) | size lq_tmp_x_868 == 1 + size lq_tmp_x_872}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{VV#782 : t^"lq_tmp_x_784" "lq_tmp_x_788" | VV#782 == v#a1Kc}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_876 : (List.List {VV#852 : t^"lq_tmp_x_854" | $k__853[VV#855:=lq_tmp_x_876][lq_tmp_x_848:=fix##36#dOrd_a1My][lq_tmp_x_849:=lq_anf__d1NZ][lq_tmp_x_850:=k#a1Kb][lq_tmp_x_851:=m#a1Kd][lq_tmp_x_858:=lq_tmp_x_876]})^"lq_tmp_x_857" "lq_tmp_x_103" | lq_tmp_x_876 == lq_anf__d1O0}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_849:{lq_tmp_x_858 : (List.List {VV#852 : t^"lq_tmp_x_854" | $k__853[VV#855:=lq_tmp_x_858][lq_tmp_x_848:=fix##36#dOrd_a1My]})^"lq_tmp_x_857" "lq_tmp_x_96" | $k__856[VV#855:=lq_tmp_x_858][lq_tmp_x_848:=fix##36#dOrd_a1My]} -&gt; lq_tmp_x_850:{VV#859 : k^"lq_tmp_x_861" "lq_tmp_x_98" | $k__860[lq_tmp_x_848:=fix##36#dOrd_a1My]} -&gt; lq_tmp_x_851:(Data.Map.Base.Map {VV#859 : k^"lq_tmp_x_861" "lq_tmp_x_100" | $k__860[lq_tmp_x_848:=fix##36#dOrd_a1My]} {lq_tmp_x_858 : (List.List {VV#852 : t^"lq_tmp_x_854" | $k__853[VV#855:=lq_tmp_x_858][lq_tmp_x_848:=fix##36#dOrd_a1My]})^"lq_tmp_x_857" "lq_tmp_x_101" | $k__856[VV#855:=lq_tmp_x_858][lq_tmp_x_848:=fix##36#dOrd_a1My]}) -&gt; {lq_tmp_x_858 : (List.List {VV#852 : t^"lq_tmp_x_854" | $k__853[VV#855:=lq_tmp_x_858][lq_tmp_x_848:=fix##36#dOrd_a1My]})^"lq_tmp_x_857" "lq_tmp_x_103" | $k__856[VV#855:=lq_tmp_x_858][lq_tmp_x_848:=fix##36#dOrd_a1My]}</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>findWithDefault</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_837 : (List.List a) | size lq_tmp_x_837 == 0}</span><span class='hs-varid'>empty</span></a> <a class=annot href="#"><span class=annottext>{VV#779 : k^"lq_tmp_x_781" | VV#779 == k#a1Kb}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_865 : (Data.Map.Base.Map {VV#793 : k^"lq_tmp_x_795" | $k__794[VV#802:=lq_tmp_x_865]} {lq_tmp_x_864 : (List.List {VV#796 : t^"lq_tmp_x_798" | $k__797[VV#799:=lq_tmp_x_864][VV#802:=lq_tmp_x_865]})^"lq_tmp_x_801" | $k__800[VV#799:=lq_tmp_x_864][VV#802:=lq_tmp_x_865]})^"lq_tmp_x_804" | lq_tmp_x_865 == m#a1Kd}</span><span class='hs-varid'>m</span></a><span class='hs-layout'>)</span>
</pre>
<h2 id="step-3-reduce-each-key-to-single-value">Step 3: Reduce Each Key to Single Value</h2>
<pre><span class=hs-linenum>68: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>collapse</span>  <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-keyword'>{l:</span><span class='hs-conid'>List</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>| size(l)&gt;0}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>69: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_733:(lq_tmp_x_731:v -&gt; lq_tmp_x_732:v -&gt; v) -&gt; lq_tmp_x_734:(Data.Map.Base.Map k {l : (List.List v) | size l &gt; 0}) -&gt; (Data.Map.Base.Map k v)</span><span class='hs-definition'>collapse</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_731:v -&gt; lq_tmp_x_732:v -&gt; v</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_776:{lq_tmp_x_774 : (List.List {VV#745 : v^"lq_tmp_x_747" | $k__746[lq_tmp_x_743:=f#a1Kf][lq_tmp_x_738:=lq_tmp_x_774]}) | size lq_tmp_x_774 &gt; 0} -&gt; {VV#745 : v^"lq_tmp_x_747" | $k__746[lq_tmp_x_743:=f#a1Kf][lq_tmp_x_744:=lq_tmp_x_776]}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>foldr1</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_750:v -&gt; lq_tmp_x_751:v -&gt; v</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>70: </span>
<span class=hs-linenum>71: </span><span class='hs-definition'>toList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>72: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_548:{VV#555 : (Data.Map.Base.Map {VV#549 : k^"lq_tmp_x_551" | $k__550} {VV#552 : v^"lq_tmp_x_554" | $k__553})^"lq_tmp_x_557" | $k__556} -&gt; {VV#571 : (List.List {VV#568 : ({VV#558 : k^"lq_tmp_x_560" | $k__559}, {VV#561 : v^"lq_tmp_x_563" | $k__562})^"lq_tmp_x_570" | $k__569})^"lq_tmp_x_573" | $k__572}</span><span class='hs-definition'>toList</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_688:{lq_tmp_x_714 : (List.List {lq_tmp_x_713 : ({VV#696 : k^"lq_tmp_x_698" | $k__697[VV#706:=lq_tmp_x_713][VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]}, {VV#699 : v^"lq_tmp_x_701" | $k__700[VV#706:=lq_tmp_x_713][VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]})^"lq_tmp_x_708" | $k__707[VV#706:=lq_tmp_x_713][VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]})^"lq_tmp_x_711" "lq_tmp_x_87" | $k__710[VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]} -&gt; lq_tmp_x_689:(Data.Map.Base.Map {VV#690 : k^"lq_tmp_x_692" "lq_tmp_x_89" | $k__691[lq_tmp_x_687:=lq_anf__d1NV]} {VV#693 : v^"lq_tmp_x_695" "lq_tmp_x_90" | $k__694[lq_tmp_x_687:=lq_anf__d1NV]}) -&gt; {lq_tmp_x_714 : (List.List {lq_tmp_x_713 : ({VV#696 : k^"lq_tmp_x_698" | $k__697[VV#706:=lq_tmp_x_713][VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]}, {VV#699 : v^"lq_tmp_x_701" | $k__700[VV#706:=lq_tmp_x_713][VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]})^"lq_tmp_x_708" | $k__707[VV#706:=lq_tmp_x_713][VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]})^"lq_tmp_x_711" "lq_tmp_x_92" | $k__710[VV#709:=lq_tmp_x_714][lq_tmp_x_687:=lq_anf__d1NV]}</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>foldrWithKey</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV#574 : k^"lq_tmp_x_576" | $k__575}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{VV#578 : v^"lq_tmp_x_580" | $k__579}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{VV#595 : (List.List {VV#592 : ({VV#582 : k^"lq_tmp_x_584" | $k__583}, {VV#585 : v^"lq_tmp_x_587" | $k__586})^"lq_tmp_x_594" | $k__593})^"lq_tmp_x_597" | $k__596}</span><span class='hs-varid'>acc</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_638:(List.List {lq_tmp_x_653 : ({VV#639 : k^"lq_tmp_x_641" | $k__640[VV#649:=lq_tmp_x_653][lq_tmp_x_637:=lq_anf__d1NU]}, {VV#642 : v^"lq_tmp_x_644" | $k__643[VV#649:=lq_tmp_x_653][lq_tmp_x_637:=lq_anf__d1NU]})^"lq_tmp_x_651" | $k__650[VV#649:=lq_tmp_x_653][lq_tmp_x_637:=lq_anf__d1NU]}) -&gt; {lq_tmp_x_634 : (List.List {lq_tmp_x_653 : ({VV#639 : k^"lq_tmp_x_641" | $k__640[VV#649:=lq_tmp_x_653][lq_tmp_x_637:=lq_anf__d1NU]}, {VV#642 : v^"lq_tmp_x_644" | $k__643[VV#649:=lq_tmp_x_653][lq_tmp_x_637:=lq_anf__d1NU]})^"lq_tmp_x_651" | $k__650[VV#649:=lq_tmp_x_653][lq_tmp_x_637:=lq_anf__d1NU]}) | size lq_tmp_x_634 == 1 + size lq_tmp_x_638}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_655 : ({VV#621 : k^"lq_tmp_x_623" | $k__622[lq_tmp_x_619:=k#a1Kg][lq_tmp_x_620:=v#a1Kh][lq_tmp_x_616:=lq_tmp_x_655]}, {VV#624 : v^"lq_tmp_x_626" | $k__625[lq_tmp_x_619:=k#a1Kg][lq_tmp_x_620:=v#a1Kh][lq_tmp_x_616:=lq_tmp_x_655]}) | lq_tmp_x_655 == lq_anf__d1NU}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV#574 : k^"lq_tmp_x_576" | VV#574 == k#a1Kg}</span><span class='hs-varid'>k</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV#578 : v^"lq_tmp_x_580" | VV#578 == v#a1Kh}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_658 : (List.List {lq_tmp_x_657 : ({VV#582 : k^"lq_tmp_x_584" | $k__583[VV#592:=lq_tmp_x_657][VV#595:=lq_tmp_x_658]}, {VV#585 : v^"lq_tmp_x_587" | $k__586[VV#592:=lq_tmp_x_657][VV#595:=lq_tmp_x_658]})^"lq_tmp_x_594" | $k__593[VV#592:=lq_tmp_x_657][VV#595:=lq_tmp_x_658]})^"lq_tmp_x_597" | lq_tmp_x_658 == acc#a1Ki}</span><span class='hs-varid'>acc</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_660 : (List.List a) | size lq_tmp_x_660 == 0}</span><span class='hs-varid'>empty</span></a>
</pre>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>
