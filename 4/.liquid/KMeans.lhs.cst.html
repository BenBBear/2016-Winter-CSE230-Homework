<h1 id="k-means-clustering">K-Means Clustering</h1>
<div class="hidden">
<pre><span class=hs-linenum> 7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span>    <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 9: </span>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>PointNE</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Point</span> <span class='hs-keyglyph'>|</span> <span class='hs-num'>0</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>size</span><span class='hs-layout'>(</span><span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>12: </span>
<span class=hs-linenum>13: </span>
<span class=hs-linenum>14: </span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>clusterDimension</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>16: </span>    <span class='hs-varid'>clusterDimension</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-layout'>,</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span><span class='hs-layout'>(</span><span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<span class=hs-linenum>17: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>18: </span>
<span class=hs-linenum>19: </span>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>KMeans</span> <span class='hs-layout'>(</span><span class='hs-varid'>kmeans</span><span class='hs-layout'>,</span> <span class='hs-varid'>kmeans1</span><span class='hs-layout'>,</span> <span class='hs-varid'>nearest</span><span class='hs-layout'>,</span> <span class='hs-varid'>mergeCluster</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>minimumBy</span><span class='hs-layout'>)</span>
<span class=hs-linenum>25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>MapReduce</span>
<span class=hs-linenum>26: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Assert</span>
<span class=hs-linenum>27: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>List</span>
<span class=hs-linenum>28: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span><span class='hs-layout'>,</span> <span class='hs-varid'>repeat</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span><span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span><span class='hs-layout'>)</span>
<span class=hs-linenum>29: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<span class=hs-linenum>30: </span>
<span class=hs-linenum>31: </span><span class='hs-definition'>centroid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>32: </span><span class='hs-definition'>distance</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>33: </span><span class='hs-definition'>nearest</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Center</span>
<span class=hs-linenum>34: </span><span class='hs-definition'>mergeCluster</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cluster</span>
<span class=hs-linenum>35: </span><span class='hs-definition'>kmeans1</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span>
<span class=hs-linenum>36: </span><span class='hs-definition'>kmeans</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span>
</pre>
</div>
<p>Next, lets use our <code>MapReduce</code> library to implement <a href="http://en.wikipedia.org/wiki/K-means_clustering">K-Means Clustering</a></p>
<h2 id="points-and-clusters">Points and Clusters</h2>
<p>First, lets define the various types that model the key entities in clustering.</p>
<pre><span class=hs-linenum>51: </span><span class='hs-comment'>-- | N-Dimensional Point</span>
<span class=hs-linenum>52: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Point</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>53: </span>
<span class=hs-linenum>54: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>PointN</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Double</span> <span class='hs-conid'>N</span> <span class='hs-keyword'>@-}</span>
</pre>
<p><strong>A Center</strong> is a number between <code>0</code> and <code>k</code> (written <code>CenterK k</code>).</p>
<pre><span class=hs-linenum>60: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Center</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>61: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>CenterK</span> <span class='hs-conid'>K</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>|</span> <span class='hs-num'>0</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;</span> <span class='hs-conid'>K</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>
<p><strong>A Centering</strong> is a map from <code>Center</code>s to <code>Point</code>s. Our clustering algorithm will aim to group a (large) set of <code>Point</code>s into <code>k</code> representatives. Thus, a <em>k-n-Centering</em> is a map from <code>CenterK k</code> to <code>PointN n</code>:</p>
<pre><span class=hs-linenum>69: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Center</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>70: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-conid'>K</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-layout'>(</span><span class='hs-conid'>CenterK</span> <span class='hs-conid'>K</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>PointN</span> <span class='hs-conid'>N</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
</pre>
<p><strong>A Cluster</strong> is a pair of a <em>number</em> of points (denoting the cluster size) and the <em>co-ordinates</em> denoting the (sum of) the co-ordinates of all the points in the cluster. We represent <code>n</code>-dimensional clusters as <code>ClusterN n</code>; note that the cluster size is <em>strictly positive</em> as we will never represent empty clusters.</p>
<pre><span class=hs-linenum>79: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Point</span><span class='hs-layout'>)</span>
<span class=hs-linenum>80: </span>
<span class=hs-linenum>81: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ClusterN</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pos</span><span class='hs-layout'>,</span> <span class='hs-conid'>PointN</span> <span class='hs-conid'>N</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>82: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos</span>        <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>
<h2 id="a-computing-euclidean-distance">(a) Computing Euclidean Distance</h2>
<p>If you did the <code>zipWith</code> problem, then you should see an error in the implementation of <code>distance</code> which computes the <a href="http://en.wikipedia.org/wiki/Euclidean_distance">Euclidean Distance</a> between two points. Fix the <strong>specification</strong> (not the code) of <code>distance</code> so that the code is verified by LH:</p>
<pre><span class=hs-linenum>95: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>distance</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>96: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1141:{v : Int | v &gt; 0} -&gt; lq_tmp_x_1142:{v : (List Double) | size v == lq_tmp_x_1141} -&gt; lq_tmp_x_1143:{v : (List Double) | size v == lq_tmp_x_1141} -&gt; Double</span><span class='hs-definition'>distance</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v : (List Double) | size v == n#a2kC}</span><span class='hs-varid'>px</span></a> <a class=annot href="#"><span class=annottext>{v : (List Double) | size v == n#a2kC}</span><span class='hs-varid'>py</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1365:Double -&gt; Double</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1184:{lq_tmp_x_1193 : Double^"lq_tmp_x_1192" "lq_tmp_x_137" | $k__1191[VV#1190:=lq_tmp_x_1193][lq_tmp_x_1183:=lq_anf__d2rF]} -&gt; lq_tmp_x_1185:(List {lq_tmp_x_1189 : Double^"lq_tmp_x_1188" "lq_tmp_x_139" | $k__1187[VV#1186:=lq_tmp_x_1189][lq_tmp_x_1183:=lq_anf__d2rF]}) -&gt; {lq_tmp_x_1193 : Double^"lq_tmp_x_1192" "lq_tmp_x_141" | $k__1191[VV#1190:=lq_tmp_x_1193][lq_tmp_x_1183:=lq_anf__d2rF]}</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1199:Double -&gt; lq_tmp_x_1200:Double -&gt; {lq_tmp_x_1196 : Double^"lq_tmp_x_1164" | lq_tmp_x_1196 == lq_tmp_x_1199 + lq_tmp_x_1200}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1201 : Double | lq_tmp_x_1201 == lq_anf__d2rG}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1296:(List {lq_tmp_x_1301 : Double^"lq_tmp_x_1300" | $k__1299[VV#1298:=lq_tmp_x_1301][lq_tmp_x_1295:=lq_anf__d2rN]}) -&gt; lq_tmp_x_1297:{lq_tmp_x_1288 : (List {lq_tmp_x_1305 : Double^"lq_tmp_x_1304" | $k__1303[VV#1302:=lq_tmp_x_1305][lq_tmp_x_1295:=lq_anf__d2rN]}) | size lq_tmp_x_1288 == size lq_tmp_x_1296} -&gt; {lq_tmp_x_1289 : (List {lq_tmp_x_1309 : Double^"lq_tmp_x_1308" | $k__1307[VV#1306:=lq_tmp_x_1309][lq_tmp_x_1295:=lq_anf__d2rN]}) | size lq_tmp_x_1289 == size lq_tmp_x_1296}</span><span class='hs-varid'>zipWith</span></a> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV#1203 : Double^"lq_tmp_x_1205" | $k__1204}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV#1207 : Double^"lq_tmp_x_1209" | $k__1208}</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1278:Double -&gt; Double</span><span class='hs-varid'>abs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1283 : Double^"lq_tmp_x_1267" | lq_tmp_x_1283 == lq_anf__d2rM}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1234 : Double^"lq_tmp_x_1205" | lq_tmp_x_1234 == x#a2kF}</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1224:Double -&gt; lq_tmp_x_1225:Integer -&gt; Double</span><span class='hs-varop'>^</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1235 : Integer | lq_tmp_x_1235 == lq_anf__d2rI}</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1265:Double -&gt; lq_tmp_x_1266:Double -&gt; {lq_tmp_x_1268 : Double^"lq_tmp_x_1267" | lq_tmp_x_1268 == lq_tmp_x_1265 - lq_tmp_x_1266}</span><span class='hs-comment'>-</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1257 : Double^"lq_tmp_x_1209" | lq_tmp_x_1257 == y#a2kG}</span><span class='hs-varid'>y</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1247:Double -&gt; lq_tmp_x_1248:Integer -&gt; Double</span><span class='hs-varop'>^</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1258 : Integer | lq_tmp_x_1258 == lq_anf__d2rK}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1318 : (List Double) | lq_tmp_x_1318 == px#a2kD}</span><span class='hs-varid'>px</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1320 : (List Double) | lq_tmp_x_1320 == py#a2kE}</span><span class='hs-varid'>py</span></a>
</pre>
<h2 id="b-map-points-to-nearest-center">(b) Map Points To Nearest Center</h2>
<p>Use <code>distance</code> to fill in the <strong>implementation</strong> of <code>nearest</code> so that LH verifies the given type signature.</p>
<pre><span class=hs-linenum>106: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>nearest</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenterK</span> <span class='hs-varid'>k</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>107: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1368:{v : Int | v &gt; 0} -&gt; lq_tmp_x_1369:{v : Int | v &gt; 0} -&gt; lq_tmp_x_1370:(Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; lq_tmp_x_1368} {v : (List Double) | size v == lq_tmp_x_1369}) -&gt; lq_tmp_x_1371:{v : (List Double) | size v == lq_tmp_x_1369} -&gt; {v : Int | 0 &lt;= v &amp;&amp; v &lt; lq_tmp_x_1368}</span><span class='hs-definition'>nearest</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; k#a2kH} {v : (List Double) | size v == n#a2kI})</span><span class='hs-varid'>centers</span></a> <a class=annot href="#"><span class=annottext>{v : (List Double) | size v == n#a2kI}</span><span class='hs-varid'>p</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1431:{lq_tmp_x_1427 : (Map {lq_tmp_x_1435 : Int^"lq_tmp_x_1434" "lq_tmp_x_985" | $k__1433[VV#1432:=lq_tmp_x_1435][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren] &amp;&amp; $k__984[VV#989:=lq_tmp_x_1427][fix##36#dOrd_a2n1:=fix#GHC.Classes.#36#fOrdDouble#35#ren][VV#983:=lq_tmp_x_1435][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren]} {lq_tmp_x_1439 : Double^"lq_tmp_x_1438" "lq_tmp_x_988" | $k__1437[VV#1436:=lq_tmp_x_1439][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren] &amp;&amp; $k__987[VV#989:=lq_tmp_x_1427][fix##36#dOrd_a2n1:=fix#GHC.Classes.#36#fOrdDouble#35#ren][VV#986:=lq_tmp_x_1439][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren]})^"lq_tmp_x_991" | $k__990[VV#989:=lq_tmp_x_1427][fix##36#dOrd_a2n1:=fix#GHC.Classes.#36#fOrdDouble#35#ren][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren]} -&gt; {lq_tmp_x_1435 : Int^"lq_tmp_x_1434" "lq_tmp_x_994" | $k__1433[VV#1432:=lq_tmp_x_1435][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren] &amp;&amp; $k__993[fix##36#dOrd_a2n1:=fix#GHC.Classes.#36#fOrdDouble#35#ren][lq_tmp_x_982:=lq_tmp_x_1431][VV#992:=lq_tmp_x_1435][lq_tmp_x_1430:=fix#GHC.Classes.#36#fOrdDouble#35#ren]}</span><span class='hs-varid'>minKeyMap</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1444 : (Map {lq_tmp_x_1442 : Int^"lq_tmp_x_1414" "lq_tmp_x_177" | $k__1413[VV#1412:=lq_tmp_x_1442][lq_tmp_x_1398:=lq_anf__d2rQ][lq_tmp_x_1399:=centers#a2kJ][lq_tmp_x_1415:=lq_tmp_x_1442][lq_tmp_x_1394:=lq_tmp_x_1444]} {lq_tmp_x_1443 : Double^"lq_tmp_x_1410" "lq_tmp_x_178" | $k__1409[VV#1408:=lq_tmp_x_1443][lq_tmp_x_1398:=lq_anf__d2rQ][lq_tmp_x_1399:=centers#a2kJ][lq_tmp_x_1411:=lq_tmp_x_1443][lq_tmp_x_1394:=lq_tmp_x_1444]})^"lq_tmp_x_179" | lq_tmp_x_1444 == lq_anf__d2rR}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1399:(Map {lq_tmp_x_1415 : Int^"lq_tmp_x_1414" "lq_tmp_x_174" | $k__1413[VV#1412:=lq_tmp_x_1415][lq_tmp_x_1398:=lq_anf__d2rQ]} {lq_tmp_x_1407 : (List {lq_tmp_x_1406 : Double^"lq_tmp_x_1402" | $k__1401[VV#1400:=lq_tmp_x_1406][VV#1403:=lq_tmp_x_1407][lq_tmp_x_1398:=lq_anf__d2rQ]})^"lq_tmp_x_1405" "lq_tmp_x_175" | $k__1404[VV#1403:=lq_tmp_x_1407][lq_tmp_x_1398:=lq_anf__d2rQ]}) -&gt; (Map {lq_tmp_x_1415 : Int^"lq_tmp_x_1414" "lq_tmp_x_177" | $k__1413[VV#1412:=lq_tmp_x_1415][lq_tmp_x_1398:=lq_anf__d2rQ]} {lq_tmp_x_1411 : Double^"lq_tmp_x_1410" "lq_tmp_x_178" | $k__1409[VV#1408:=lq_tmp_x_1411][lq_tmp_x_1398:=lq_anf__d2rQ]})</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1420:{lq_tmp_x_1417 : (List Double) | size lq_tmp_x_1417 == n#a2kI} -&gt; Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1385:{lq_tmp_x_1376 : Int | lq_tmp_x_1376 &gt; 0} -&gt; lq_tmp_x_1386:{lq_tmp_x_1378 : (List Double) | size lq_tmp_x_1378 == lq_tmp_x_1385} -&gt; lq_tmp_x_1387:{lq_tmp_x_1380 : (List Double) | size lq_tmp_x_1380 == lq_tmp_x_1385} -&gt; Double</span><span class='hs-varid'>distance</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1388 : Int | lq_tmp_x_1388 == n#a2kI}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1390 : (List Double) | lq_tmp_x_1390 == p#a2kK}</span><span class='hs-varid'>p</span></a><span class='hs-layout'>)</span>  <a class=annot href="#"><span class=annottext>{lq_tmp_x_1424 : (Map {lq_tmp_x_1421 : Int | 0 &lt;= lq_tmp_x_1421 &amp;&amp; lq_tmp_x_1421 &lt; k#a2kH} {lq_tmp_x_1423 : (List Double) | size lq_tmp_x_1423 == n#a2kI}) | lq_tmp_x_1424 == centers#a2kJ}</span><span class='hs-varid'>centers</span></a><span class='hs-layout'>)</span>
</pre>
<p>You may want to use the helper <code>minKeyMap</code> that computes the key with the smallest value in a <code>Map</code>:</p>
<pre><span class=hs-linenum>114: </span><span class='hs-comment'>--- &gt;&gt;&gt; minKeyMap (M.fromList [(0, 12), (1, 23), (2, 7), (3,18)])</span>
<span class=hs-linenum>115: </span><span class='hs-comment'>--- 2</span>
<span class=hs-linenum>116: </span><span class='hs-definition'>minKeyMap</span>  <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span>
<span class=hs-linenum>117: </span><a class=annot href="#"><span class=annottext>(Ord v) =&gt;
lq_tmp_x_982:{VV#989 : (Map {VV#983 : k^"lq_tmp_x_985" | $k__984} {VV#986 : v^"lq_tmp_x_988" | $k__987})^"lq_tmp_x_991" | $k__990} -&gt; {VV#992 : k^"lq_tmp_x_994" | $k__993}</span><span class='hs-definition'>minKeyMap</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1130:{lq_tmp_x_1128 : [{lq_tmp_x_1124 : ({VV#1006 : k^"lq_tmp_x_1008" "lq_tmp_x_786" | $k__1007[lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_997:=lq_tmp_x_1124][lq_tmp_x_1001:=lq_tmp_x_1128] &amp;&amp; $k__785[VV#794:=lq_tmp_x_1124][VV#811:=lq_tmp_x_1128][fix##36#dOrd_a2mG:=fix##36#dOrd_a2n1][VV#784:=VV#1006][lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_997:=lq_tmp_x_1124][lq_tmp_x_1001:=lq_tmp_x_1128]}, {VV#1009 : v^"lq_tmp_x_1011" "lq_tmp_x_789" | $k__1010[lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_997:=lq_tmp_x_1124][lq_tmp_x_1001:=lq_tmp_x_1128] &amp;&amp; $k__788[VV#794:=lq_tmp_x_1124][VV#811:=lq_tmp_x_1128][fix##36#dOrd_a2mG:=fix##36#dOrd_a2n1][VV#787:=VV#1009][lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_997:=lq_tmp_x_1124][lq_tmp_x_1001:=lq_tmp_x_1128]})^"lq_tmp_x_796" | $k__795[VV#794:=lq_tmp_x_1124][VV#811:=lq_tmp_x_1128][fix##36#dOrd_a2mG:=fix##36#dOrd_a2n1][lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_997:=lq_tmp_x_1124][lq_tmp_x_1001:=lq_tmp_x_1128]}]^"lq_tmp_x_813" | $k__812[VV#811:=lq_tmp_x_1128][fix##36#dOrd_a2mG:=fix##36#dOrd_a2n1][lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_1001:=lq_tmp_x_1128]} -&gt; {VV#1006 : k^"lq_tmp_x_1008" "lq_tmp_x_817" | $k__1007[lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_1005:=lq_tmp_x_1130] &amp;&amp; $k__816[fix##36#dOrd_a2mG:=fix##36#dOrd_a2n1][xs#a2kL:=lq_tmp_x_1130][VV#815:=VV#1006][lq_tmp_x_1004:=fix##36#dOrd_a2n1][lq_tmp_x_1005:=lq_tmp_x_1130]}</span><span class='hs-varid'>minKeyList</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1022:(Map k a) -&gt; [(k, a)]</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>toList</span>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span><span class='hs-definition'>minKeyList</span>    <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span><span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span>
<span class=hs-linenum>120: </span><a class=annot href="#"><span class=annottext>(Ord v) =&gt;
xs#a2kL:{VV#811 : [{VV#794 : ({VV#784 : k^"lq_tmp_x_786" | $k__785}, {VV#787 : v^"lq_tmp_x_789" | $k__788})^"lq_tmp_x_796" | $k__795}]^"lq_tmp_x_813" | $k__812} -&gt; {VV#815 : k^"lq_tmp_x_817" | $k__816}</span><span class='hs-definition'>minKeyList</span></a> <a class=annot href="#"><span class=annottext>{VV#811 : [{VV#794 : ({VV#784 : k^"lq_tmp_x_786" | $k__785}, {VV#787 : v^"lq_tmp_x_789" | $k__788})^"lq_tmp_x_796" | $k__795}]^"lq_tmp_x_813" | $k__812}</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_821:(a, b) -&gt; a</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_910:(lq_tmp_x_907:{lq_tmp_x_926 : ({VV#912 : k^"lq_tmp_x_914" | $k__913[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]}, {VV#915 : v^"lq_tmp_x_917" | $k__916[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]})^"lq_tmp_x_924" "lq_tmp_x_221" | $k__923[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]} -&gt; lq_tmp_x_908:{lq_tmp_x_926 : ({VV#912 : k^"lq_tmp_x_914" | $k__913[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]}, {VV#915 : v^"lq_tmp_x_917" | $k__916[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]})^"lq_tmp_x_924" "lq_tmp_x_223" | $k__923[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]} -&gt; Ordering) -&gt; lq_tmp_x_911:[{lq_tmp_x_926 : ({VV#912 : k^"lq_tmp_x_914" | $k__913[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]}, {VV#915 : v^"lq_tmp_x_917" | $k__916[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]})^"lq_tmp_x_924" "lq_tmp_x_227" | $k__923[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]}] -&gt; {lq_tmp_x_926 : ({VV#912 : k^"lq_tmp_x_914" | $k__913[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]}, {VV#915 : v^"lq_tmp_x_917" | $k__916[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]})^"lq_tmp_x_924" "lq_tmp_x_228" | $k__923[VV#922:=lq_tmp_x_926][lq_tmp_x_909:=fix#Data.Foldable.#36#fFoldable#91##93##35#r1Lo]}</span><span class='hs-varid'>minimumBy</span></a> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV#839 : ({VV#829 : k^"lq_tmp_x_831" | $k__830}, {VV#832 : v^"lq_tmp_x_834" | $k__833})^"lq_tmp_x_841" | $k__840}</span><span class='hs-varid'>x1</span></a> <a class=annot href="#"><span class=annottext>{VV#853 : ({VV#843 : k^"lq_tmp_x_845" | $k__844}, {VV#846 : v^"lq_tmp_x_848" | $k__847})^"lq_tmp_x_855" | $k__854}</span><span class='hs-varid'>x2</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_892:{VV#894 : v^"lq_tmp_x_896" | $k__895[lq_tmp_x_891:=fix##36#dOrd_a2mG]} -&gt; lq_tmp_x_893:{VV#894 : v^"lq_tmp_x_896" | $k__895[lq_tmp_x_891:=fix##36#dOrd_a2mG]} -&gt; {lq_tmp_x_887 : Ordering | (lq_tmp_x_887 == GHC.Types.EQ#6U &lt;=&gt; lq_tmp_x_892 == lq_tmp_x_893) &amp;&amp; (lq_tmp_x_887 == GHC.Types.LT#6S &lt;=&gt; lq_tmp_x_892 &lt; lq_tmp_x_893) &amp;&amp; (lq_tmp_x_887 == GHC.Types.GT#6W &lt;=&gt; lq_tmp_x_892 &gt; lq_tmp_x_893)}</span><span class='hs-varid'>compare</span></a> <a class=annot href="#"><span class=annottext>{VV#867 : v^"lq_tmp_x_869" "lq_tmp_x_12" | VV#867 == lq_anf__d2ry}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>snd</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_871 : ({VV#829 : k^"lq_tmp_x_831" | $k__830[VV#839:=lq_tmp_x_871]}, {VV#832 : v^"lq_tmp_x_834" | $k__833[VV#839:=lq_tmp_x_871]})^"lq_tmp_x_841" | lq_tmp_x_871 == x1#a2kM}</span><span class='hs-varid'>x1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV#880 : v^"lq_tmp_x_882" "lq_tmp_x_12" | VV#880 == lq_anf__d2rz}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>snd</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_884 : ({VV#843 : k^"lq_tmp_x_845" | $k__844[VV#853:=lq_tmp_x_884]}, {VV#846 : v^"lq_tmp_x_848" | $k__847[VV#853:=lq_tmp_x_884]})^"lq_tmp_x_855" | lq_tmp_x_884 == x2#a2kN}</span><span class='hs-varid'>x2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_948 : [{lq_tmp_x_944 : ({VV#784 : k^"lq_tmp_x_786" | $k__785[VV#794:=lq_tmp_x_944][VV#811:=lq_tmp_x_948]}, {VV#787 : v^"lq_tmp_x_789" | $k__788[VV#794:=lq_tmp_x_944][VV#811:=lq_tmp_x_948]})^"lq_tmp_x_796" | $k__795[VV#794:=lq_tmp_x_944][VV#811:=lq_tmp_x_948]}]^"lq_tmp_x_813" | lq_tmp_x_948 == xs#a2kL}</span><span class='hs-varid'>xs</span></a>
</pre>
<p>When you are done, you should get the following behavior:</p>
<pre><span class=hs-linenum>127: </span><span class='hs-comment'>-- &gt;&gt;&gt; test_nearest</span>
<span class=hs-linenum>128: </span><span class='hs-comment'>-- 1</span>
<span class=hs-linenum>129: </span><a class=annot href="#"><span class=annottext>{VV#1446 : Int^"lq_tmp_x_1448" | $k__1447}</span><span class='hs-definition'>test_nearest</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2096:{lq_tmp_x_2083 : Int | lq_tmp_x_2083 &gt; 0} -&gt; lq_tmp_x_2097:{lq_tmp_x_2084 : Int | lq_tmp_x_2084 &gt; 0} -&gt; lq_tmp_x_2098:(Map {lq_tmp_x_2085 : Int | 0 &lt;= lq_tmp_x_2085 &amp;&amp; lq_tmp_x_2085 &lt; lq_tmp_x_2096} {lq_tmp_x_2087 : (List Double) | size lq_tmp_x_2087 == lq_tmp_x_2097}) -&gt; lq_tmp_x_2099:{lq_tmp_x_2090 : (List Double) | size lq_tmp_x_2090 == lq_tmp_x_2097} -&gt; {lq_tmp_x_2091 : Int | 0 &lt;= lq_tmp_x_2091 &amp;&amp; lq_tmp_x_2091 &lt; lq_tmp_x_2096}</span><span class='hs-varid'>nearest</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2100 : Int | lq_tmp_x_2100 == lq_anf__d2s8}</span><span class='hs-num'>3</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2101 : Int | lq_tmp_x_2101 == lq_anf__d2s9}</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2105 : (Map {lq_tmp_x_2102 : Int^"lq_tmp_x_2054" "lq_tmp_x_192" | $k__2053[VV#2052:=lq_tmp_x_2102][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2051:=lq_anf__d2sj][lq_tmp_x_2055:=lq_tmp_x_2102][lq_tmp_x_2047:=lq_tmp_x_2105]} {lq_tmp_x_2104 : (List {lq_tmp_x_2103 : Double^"lq_tmp_x_2058" | $k__2057[VV#2056:=lq_tmp_x_2103][VV#2059:=lq_tmp_x_2104][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2051:=lq_anf__d2sj][lq_tmp_x_2062:=lq_tmp_x_2103][lq_tmp_x_2063:=lq_tmp_x_2104][lq_tmp_x_2047:=lq_tmp_x_2105]})^"lq_tmp_x_2061" "lq_tmp_x_193" | $k__2060[VV#2059:=lq_tmp_x_2104][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2051:=lq_anf__d2sj][lq_tmp_x_2063:=lq_tmp_x_2104][lq_tmp_x_2047:=lq_tmp_x_2105]})^"lq_tmp_x_194" | lq_tmp_x_2105 == lq_anf__d2sk}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_2051:[({lq_tmp_x_2055 : Int^"lq_tmp_x_2054" "lq_tmp_x_183" | $k__2053[VV#2052:=lq_tmp_x_2055][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2063 : (List {lq_tmp_x_2062 : Double^"lq_tmp_x_2058" | $k__2057[VV#2056:=lq_tmp_x_2062][VV#2059:=lq_tmp_x_2063][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2061" "lq_tmp_x_184" | $k__2060[VV#2059:=lq_tmp_x_2063][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})] -&gt; (Map {lq_tmp_x_2055 : Int^"lq_tmp_x_2054" "lq_tmp_x_192" | $k__2053[VV#2052:=lq_tmp_x_2055][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS]} {lq_tmp_x_2063 : (List {lq_tmp_x_2062 : Double^"lq_tmp_x_2058" | $k__2057[VV#2056:=lq_tmp_x_2062][VV#2059:=lq_tmp_x_2063][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2061" "lq_tmp_x_193" | $k__2060[VV#2059:=lq_tmp_x_2063][lq_tmp_x_2050:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>fromList</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2081 : [{lq_tmp_x_2072 : ({lq_tmp_x_2066 : Int^"lq_tmp_x_1971" | $k__1970[VV#1969:=lq_tmp_x_2066][VV#1985:=lq_tmp_x_2072][lq_tmp_x_1967:=lq_anf__d2sb][lq_tmp_x_1968:=lq_anf__d2si][lq_tmp_x_1988:=lq_tmp_x_2066][lq_tmp_x_1994:=lq_tmp_x_2072][lq_tmp_x_1964:=lq_tmp_x_2081]}, {lq_tmp_x_2068 : (List {lq_tmp_x_2067 : Double^"lq_tmp_x_1974" | $k__1973[VV#1972:=lq_tmp_x_2067][VV#1975:=lq_tmp_x_2068][VV#1985:=lq_tmp_x_2072][lq_tmp_x_1967:=lq_anf__d2sb][lq_tmp_x_1968:=lq_anf__d2si][lq_tmp_x_1989:=lq_tmp_x_2067][lq_tmp_x_1990:=lq_tmp_x_2068][lq_tmp_x_1994:=lq_tmp_x_2072][lq_tmp_x_1964:=lq_tmp_x_2081]})^"lq_tmp_x_1977" | $k__1976[VV#1975:=lq_tmp_x_2068][VV#1985:=lq_tmp_x_2072][lq_tmp_x_1967:=lq_anf__d2sb][lq_tmp_x_1968:=lq_anf__d2si][lq_tmp_x_1990:=lq_tmp_x_2068][lq_tmp_x_1994:=lq_tmp_x_2072][lq_tmp_x_1964:=lq_tmp_x_2081]})^"lq_tmp_x_1987" | $k__1986[VV#1985:=lq_tmp_x_2072][lq_tmp_x_1967:=lq_anf__d2sb][lq_tmp_x_1968:=lq_anf__d2si][lq_tmp_x_1994:=lq_tmp_x_2072][lq_tmp_x_1964:=lq_tmp_x_2081]}] | lq_tmp_x_2081 == lq_anf__d2sj}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2022 : ({lq_tmp_x_2016 : Int^"lq_tmp_x_1659" | $k__1658[VV#1657:=lq_tmp_x_2016][lq_tmp_x_1655:=lq_anf__d2sa][lq_tmp_x_1656:=p0#a2kO][lq_tmp_x_1660:=lq_tmp_x_2016][lq_tmp_x_1652:=lq_tmp_x_2022]}, {lq_tmp_x_2018 : (List {lq_tmp_x_2017 : Double^"lq_tmp_x_1663" | $k__1662[VV#1661:=lq_tmp_x_2017][VV#1664:=lq_tmp_x_2018][lq_tmp_x_1655:=lq_anf__d2sa][lq_tmp_x_1656:=p0#a2kO][lq_tmp_x_1667:=lq_tmp_x_2017][lq_tmp_x_1668:=lq_tmp_x_2018][lq_tmp_x_1652:=lq_tmp_x_2022]})^"lq_tmp_x_1666" | $k__1665[VV#1664:=lq_tmp_x_2018][lq_tmp_x_1655:=lq_anf__d2sa][lq_tmp_x_1656:=p0#a2kO][lq_tmp_x_1668:=lq_tmp_x_2018][lq_tmp_x_1652:=lq_tmp_x_2022]}) | lq_tmp_x_2022 == lq_anf__d2sb}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1677 : Int | lq_tmp_x_1677 == lq_anf__d2sa}</span><span class='hs-num'>0</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1679 : (List {lq_tmp_x_1678 : Double^"lq_tmp_x_1627" | $k__1626[VV#1625:=lq_tmp_x_1678][lq_tmp_x_1623:=lq_anf__d2s4][lq_tmp_x_1624:=lq_anf__d2s7][lq_tmp_x_1628:=lq_tmp_x_1678][lq_tmp_x_1620:=lq_tmp_x_1679]}) | lq_tmp_x_1679 == p0#a2kO}</span><span class='hs-varid'>p0</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1943 : ({lq_tmp_x_1937 : Int^"lq_tmp_x_1695" | $k__1694[VV#1693:=lq_tmp_x_1937][lq_tmp_x_1691:=lq_anf__d2sc][lq_tmp_x_1692:=p1#a2kP][lq_tmp_x_1696:=lq_tmp_x_1937][lq_tmp_x_1688:=lq_tmp_x_1943]}, {lq_tmp_x_1939 : (List {lq_tmp_x_1938 : Double^"lq_tmp_x_1699" | $k__1698[VV#1697:=lq_tmp_x_1938][VV#1700:=lq_tmp_x_1939][lq_tmp_x_1691:=lq_anf__d2sc][lq_tmp_x_1692:=p1#a2kP][lq_tmp_x_1703:=lq_tmp_x_1938][lq_tmp_x_1704:=lq_tmp_x_1939][lq_tmp_x_1688:=lq_tmp_x_1943]})^"lq_tmp_x_1702" | $k__1701[VV#1700:=lq_tmp_x_1939][lq_tmp_x_1691:=lq_anf__d2sc][lq_tmp_x_1692:=p1#a2kP][lq_tmp_x_1704:=lq_tmp_x_1939][lq_tmp_x_1688:=lq_tmp_x_1943]}) | lq_tmp_x_1943 == lq_anf__d2sd}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1713 : Int | lq_tmp_x_1713 == lq_anf__d2sc}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1715 : (List {lq_tmp_x_1714 : Double^"lq_tmp_x_1581" | $k__1580[VV#1579:=lq_tmp_x_1714][lq_tmp_x_1577:=lq_anf__d2s0][lq_tmp_x_1578:=lq_anf__d2s3][lq_tmp_x_1582:=lq_tmp_x_1714][lq_tmp_x_1574:=lq_tmp_x_1715]}) | lq_tmp_x_1715 == p1#a2kP}</span><span class='hs-varid'>p1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1864 : ({lq_tmp_x_1858 : Int^"lq_tmp_x_1731" | $k__1730[VV#1729:=lq_tmp_x_1858][lq_tmp_x_1727:=lq_anf__d2se][lq_tmp_x_1728:=p2#a2kQ][lq_tmp_x_1732:=lq_tmp_x_1858][lq_tmp_x_1724:=lq_tmp_x_1864]}, {lq_tmp_x_1860 : (List {lq_tmp_x_1859 : Double^"lq_tmp_x_1735" | $k__1734[VV#1733:=lq_tmp_x_1859][VV#1736:=lq_tmp_x_1860][lq_tmp_x_1727:=lq_anf__d2se][lq_tmp_x_1728:=p2#a2kQ][lq_tmp_x_1739:=lq_tmp_x_1859][lq_tmp_x_1740:=lq_tmp_x_1860][lq_tmp_x_1724:=lq_tmp_x_1864]})^"lq_tmp_x_1738" | $k__1737[VV#1736:=lq_tmp_x_1860][lq_tmp_x_1727:=lq_anf__d2se][lq_tmp_x_1728:=p2#a2kQ][lq_tmp_x_1740:=lq_tmp_x_1860][lq_tmp_x_1724:=lq_tmp_x_1864]}) | lq_tmp_x_1864 == lq_anf__d2sf}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1749 : Int | lq_tmp_x_1749 == lq_anf__d2se}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1751 : (List {lq_tmp_x_1750 : Double^"lq_tmp_x_1535" | $k__1534[VV#1533:=lq_tmp_x_1750][lq_tmp_x_1531:=lq_anf__d2rW][lq_tmp_x_1532:=lq_anf__d2rZ][lq_tmp_x_1536:=lq_tmp_x_1750][lq_tmp_x_1528:=lq_tmp_x_1751]}) | lq_tmp_x_1751 == p2#a2kQ}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2107 : (List {lq_tmp_x_2106 : Double^"lq_tmp_x_1489" | $k__1488[VV#1487:=lq_tmp_x_2106][lq_tmp_x_1485:=lq_anf__d2rS][lq_tmp_x_1486:=lq_anf__d2rV][lq_tmp_x_1490:=lq_tmp_x_2106][lq_tmp_x_1482:=lq_tmp_x_2107]}) | lq_tmp_x_2107 == p#a2kR}</span><span class='hs-varid'>p</span></a>
<span class=hs-linenum>130: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>131: </span>    <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-varid'>p0</span><span class='hs-layout'>,</span> <span class='hs-varid'>p1</span><span class='hs-layout'>,</span> <span class='hs-varid'>p2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>132: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_1620 : (List {lq_tmp_x_1628 : Double^"lq_tmp_x_1627" | $k__1626[VV#1625:=lq_tmp_x_1628][lq_tmp_x_1623:=lq_anf__d2s4][lq_tmp_x_1624:=lq_anf__d2s7]}) | size lq_tmp_x_1620 == 1 + size lq_anf__d2s7}</span><span class='hs-varid'>p0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1624:(List {lq_tmp_x_1628 : Double^"lq_tmp_x_1627" | $k__1626[VV#1625:=lq_tmp_x_1628][lq_tmp_x_1623:=lq_anf__d2s4]}) -&gt; {lq_tmp_x_1620 : (List {lq_tmp_x_1628 : Double^"lq_tmp_x_1627" | $k__1626[VV#1625:=lq_tmp_x_1628][lq_tmp_x_1623:=lq_anf__d2s4]}) | size lq_tmp_x_1620 == 1 + size lq_tmp_x_1624}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1629 : Double | lq_tmp_x_1629 == lq_anf__d2s4}</span><span class='hs-num'>0.0</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1631 : (List {lq_tmp_x_1630 : Double^"lq_tmp_x_1613" | $k__1612[VV#1611:=lq_tmp_x_1630][lq_tmp_x_1609:=lq_anf__d2s5][lq_tmp_x_1610:=lq_anf__d2s6][lq_tmp_x_1614:=lq_tmp_x_1630][lq_tmp_x_1606:=lq_tmp_x_1631]}) | lq_tmp_x_1631 == lq_anf__d2s7}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1610:(List {lq_tmp_x_1614 : Double^"lq_tmp_x_1613" | $k__1612[VV#1611:=lq_tmp_x_1614][lq_tmp_x_1609:=lq_anf__d2s5]}) -&gt; {lq_tmp_x_1606 : (List {lq_tmp_x_1614 : Double^"lq_tmp_x_1613" | $k__1612[VV#1611:=lq_tmp_x_1614][lq_tmp_x_1609:=lq_anf__d2s5]}) | size lq_tmp_x_1606 == 1 + size lq_tmp_x_1610}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1615 : Double | lq_tmp_x_1615 == lq_anf__d2s5}</span><span class='hs-num'>0.0</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1599 : (List a) | size lq_tmp_x_1599 == 0}</span><span class='hs-varid'>empty</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>133: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_1574 : (List {lq_tmp_x_1582 : Double^"lq_tmp_x_1581" | $k__1580[VV#1579:=lq_tmp_x_1582][lq_tmp_x_1577:=lq_anf__d2s0][lq_tmp_x_1578:=lq_anf__d2s3]}) | size lq_tmp_x_1574 == 1 + size lq_anf__d2s3}</span><span class='hs-varid'>p1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1578:(List {lq_tmp_x_1582 : Double^"lq_tmp_x_1581" | $k__1580[VV#1579:=lq_tmp_x_1582][lq_tmp_x_1577:=lq_anf__d2s0]}) -&gt; {lq_tmp_x_1574 : (List {lq_tmp_x_1582 : Double^"lq_tmp_x_1581" | $k__1580[VV#1579:=lq_tmp_x_1582][lq_tmp_x_1577:=lq_anf__d2s0]}) | size lq_tmp_x_1574 == 1 + size lq_tmp_x_1578}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1583 : Double | lq_tmp_x_1583 == lq_anf__d2s0}</span><span class='hs-num'>3.0</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1585 : (List {lq_tmp_x_1584 : Double^"lq_tmp_x_1567" | $k__1566[VV#1565:=lq_tmp_x_1584][lq_tmp_x_1563:=lq_anf__d2s1][lq_tmp_x_1564:=lq_anf__d2s2][lq_tmp_x_1568:=lq_tmp_x_1584][lq_tmp_x_1560:=lq_tmp_x_1585]}) | lq_tmp_x_1585 == lq_anf__d2s3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1564:(List {lq_tmp_x_1568 : Double^"lq_tmp_x_1567" | $k__1566[VV#1565:=lq_tmp_x_1568][lq_tmp_x_1563:=lq_anf__d2s1]}) -&gt; {lq_tmp_x_1560 : (List {lq_tmp_x_1568 : Double^"lq_tmp_x_1567" | $k__1566[VV#1565:=lq_tmp_x_1568][lq_tmp_x_1563:=lq_anf__d2s1]}) | size lq_tmp_x_1560 == 1 + size lq_tmp_x_1564}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1569 : Double | lq_tmp_x_1569 == lq_anf__d2s1}</span><span class='hs-num'>0.0</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1553 : (List a) | size lq_tmp_x_1553 == 0}</span><span class='hs-varid'>empty</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>134: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_1528 : (List {lq_tmp_x_1536 : Double^"lq_tmp_x_1535" | $k__1534[VV#1533:=lq_tmp_x_1536][lq_tmp_x_1531:=lq_anf__d2rW][lq_tmp_x_1532:=lq_anf__d2rZ]}) | size lq_tmp_x_1528 == 1 + size lq_anf__d2rZ}</span><span class='hs-varid'>p2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1532:(List {lq_tmp_x_1536 : Double^"lq_tmp_x_1535" | $k__1534[VV#1533:=lq_tmp_x_1536][lq_tmp_x_1531:=lq_anf__d2rW]}) -&gt; {lq_tmp_x_1528 : (List {lq_tmp_x_1536 : Double^"lq_tmp_x_1535" | $k__1534[VV#1533:=lq_tmp_x_1536][lq_tmp_x_1531:=lq_anf__d2rW]}) | size lq_tmp_x_1528 == 1 + size lq_tmp_x_1532}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1537 : Double | lq_tmp_x_1537 == lq_anf__d2rW}</span><span class='hs-num'>0.0</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1539 : (List {lq_tmp_x_1538 : Double^"lq_tmp_x_1521" | $k__1520[VV#1519:=lq_tmp_x_1538][lq_tmp_x_1517:=lq_anf__d2rX][lq_tmp_x_1518:=lq_anf__d2rY][lq_tmp_x_1522:=lq_tmp_x_1538][lq_tmp_x_1514:=lq_tmp_x_1539]}) | lq_tmp_x_1539 == lq_anf__d2rZ}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1518:(List {lq_tmp_x_1522 : Double^"lq_tmp_x_1521" | $k__1520[VV#1519:=lq_tmp_x_1522][lq_tmp_x_1517:=lq_anf__d2rX]}) -&gt; {lq_tmp_x_1514 : (List {lq_tmp_x_1522 : Double^"lq_tmp_x_1521" | $k__1520[VV#1519:=lq_tmp_x_1522][lq_tmp_x_1517:=lq_anf__d2rX]}) | size lq_tmp_x_1514 == 1 + size lq_tmp_x_1518}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1523 : Double | lq_tmp_x_1523 == lq_anf__d2rX}</span><span class='hs-num'>3.0</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1507 : (List a) | size lq_tmp_x_1507 == 0}</span><span class='hs-varid'>empty</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>135: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_1482 : (List {lq_tmp_x_1490 : Double^"lq_tmp_x_1489" | $k__1488[VV#1487:=lq_tmp_x_1490][lq_tmp_x_1485:=lq_anf__d2rS][lq_tmp_x_1486:=lq_anf__d2rV]}) | size lq_tmp_x_1482 == 1 + size lq_anf__d2rV}</span><span class='hs-varid'>p</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1486:(List {lq_tmp_x_1490 : Double^"lq_tmp_x_1489" | $k__1488[VV#1487:=lq_tmp_x_1490][lq_tmp_x_1485:=lq_anf__d2rS]}) -&gt; {lq_tmp_x_1482 : (List {lq_tmp_x_1490 : Double^"lq_tmp_x_1489" | $k__1488[VV#1487:=lq_tmp_x_1490][lq_tmp_x_1485:=lq_anf__d2rS]}) | size lq_tmp_x_1482 == 1 + size lq_tmp_x_1486}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1491 : Double | lq_tmp_x_1491 == lq_anf__d2rS}</span><span class='hs-num'>2.9</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1493 : (List {lq_tmp_x_1492 : Double^"lq_tmp_x_1475" | $k__1474[VV#1473:=lq_tmp_x_1492][lq_tmp_x_1471:=lq_anf__d2rT][lq_tmp_x_1472:=lq_anf__d2rU][lq_tmp_x_1476:=lq_tmp_x_1492][lq_tmp_x_1468:=lq_tmp_x_1493]}) | lq_tmp_x_1493 == lq_anf__d2rV}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1472:(List {lq_tmp_x_1476 : Double^"lq_tmp_x_1475" | $k__1474[VV#1473:=lq_tmp_x_1476][lq_tmp_x_1471:=lq_anf__d2rT]}) -&gt; {lq_tmp_x_1468 : (List {lq_tmp_x_1476 : Double^"lq_tmp_x_1475" | $k__1474[VV#1473:=lq_tmp_x_1476][lq_tmp_x_1471:=lq_anf__d2rT]}) | size lq_tmp_x_1468 == 1 + size lq_tmp_x_1472}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1477 : Double | lq_tmp_x_1477 == lq_anf__d2rT}</span><span class='hs-num'>1.1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1461 : (List a) | size lq_tmp_x_1461 == 0}</span><span class='hs-varid'>empty</span></a><span class='hs-layout'>)</span>
</pre>
<h2 id="c-reduce-clusters">(c) Reduce Clusters</h2>
<p>Fix the <strong>specification</strong> below so that that LH verifies <code>mergeCluster</code> which takes two <code>Cluster</code> and merges them by adding up their points and centers. (Leave the code unmodified).</p>
<pre><span class=hs-linenum>147: </span>
<span class=hs-linenum>148: </span>
<span class=hs-linenum>149: </span>
<span class=hs-linenum>150: </span>
<span class=hs-linenum>151: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>mergeCluster</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ClusterN</span> <span class='hs-varid'>n</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ClusterN</span> <span class='hs-varid'>n</span>  <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-conid'>ClusterN</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>152: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_2109:{v : Int | v &gt;= 0} -&gt; lq_tmp_x_2110:({v : Int | v &gt; 0}, {v : (List Double) | size v == lq_tmp_x_2109}) -&gt; lq_tmp_x_2111:({v : Int | v &gt; 0}, {v : (List Double) | size v == lq_tmp_x_2109}) -&gt; ({v : Int | v &gt; 0}, {v : (List Double) | size v == lq_tmp_x_2109})</span><span class='hs-definition'>mergeCluster</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>n1</span><span class='hs-layout'>,</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>n2</span><span class='hs-layout'>,</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2240:a -&gt; lq_tmp_x_2241:{VV : b | true} -&gt; {lq_tmp_x_2237 : (a, b) | clusterDimension lq_tmp_x_2237 == size lq_tmp_x_2241 &amp;&amp; snd lq_tmp_x_2237 == lq_tmp_x_2241 &amp;&amp; fst lq_tmp_x_2237 == lq_tmp_x_2240 &amp;&amp; x_Tuple22 lq_tmp_x_2237 == lq_tmp_x_2241 &amp;&amp; x_Tuple21 lq_tmp_x_2237 == lq_tmp_x_2240}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2184 : Int | lq_tmp_x_2184 == n1#a2kT}</span><span class='hs-varid'>n1</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_2178:Int -&gt; lq_tmp_x_2179:Int -&gt; {lq_tmp_x_2181 : Int^"lq_tmp_x_2180" | lq_tmp_x_2181 == lq_tmp_x_2178 + lq_tmp_x_2179}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2185 : Int | lq_tmp_x_2185 == n2#a2kV}</span><span class='hs-varid'>n2</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2210:(List {lq_tmp_x_2215 : Double^"lq_tmp_x_2214" | $k__2213[VV#2212:=lq_tmp_x_2215][lq_tmp_x_2209:=lq_anf__d2so]}) -&gt; lq_tmp_x_2211:{lq_tmp_x_2202 : (List {lq_tmp_x_2219 : Double^"lq_tmp_x_2218" | $k__2217[VV#2216:=lq_tmp_x_2219][lq_tmp_x_2209:=lq_anf__d2so]}) | size lq_tmp_x_2202 == size lq_tmp_x_2210} -&gt; {lq_tmp_x_2203 : (List {lq_tmp_x_2223 : Double^"lq_tmp_x_2222" | $k__2221[VV#2220:=lq_tmp_x_2223][lq_tmp_x_2209:=lq_anf__d2so]}) | size lq_tmp_x_2203 == size lq_tmp_x_2210}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_2229:Double -&gt; lq_tmp_x_2230:Double -&gt; {lq_tmp_x_2226 : Double^"lq_tmp_x_2194" | lq_tmp_x_2226 == lq_tmp_x_2229 + lq_tmp_x_2230}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2232 : (List Double) | lq_tmp_x_2232 == p1#a2kU}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2234 : (List Double) | lq_tmp_x_2234 == p2#a2kW}</span><span class='hs-varid'>p2</span></a><span class='hs-layout'>)</span>
</pre>
<p><strong>Note:</strong> The code above uses <code>zipWith</code>; so you will only see the error and be able to fix it, <em>after</em> you solve that problem.</p>
<h2 id="d-convert-cluster-into-centroid-point">(d) Convert Cluster into Centroid Point</h2>
<p>The <code>centroid</code> function converts a <code>Cluster</code> into a single <code>Point</code> by dividing each co-ordinate with the cluster size. Fix the <strong>specification</strong> of <code>centroid</code> so that LH verifies the call to <code>divide</code>:</p>
<pre><span class=hs-linenum>166: </span>
<span class=hs-linenum>167: </span>
<span class=hs-linenum>168: </span>
<span class=hs-linenum>169: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>centroid</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>170: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_740:{v : Int | v &gt;= 0} -&gt; lq_tmp_x_741:{v : (List Double) | size v == lq_tmp_x_740} -&gt; lq_tmp_x_742:{v : Int | v &gt; 0} -&gt; {v : (List Double) | size v == lq_tmp_x_740}</span><span class='hs-definition'>centroid</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v : (List Double) | size v == n#a2kX}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>sz</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_767:(List {lq_tmp_x_771 : Double^"lq_tmp_x_770" | $k__769[VV#768:=lq_tmp_x_771][lq_tmp_x_766:=lq_anf__d2rw]}) -&gt; {lq_tmp_x_762 : (List {lq_tmp_x_775 : Double^"lq_tmp_x_774" | $k__773[VV#772:=lq_tmp_x_775][lq_tmp_x_766:=lq_anf__d2rw]}) | size lq_tmp_x_762 == size lq_tmp_x_767}</span><span class='hs-varid'>map</span></a> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV#746 : Double^"lq_tmp_x_748" | $k__747}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_757 : Double^"lq_tmp_x_748" | lq_tmp_x_757 == x#a2l0}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_755:Double -&gt; lq_tmp_x_756:{lq_tmp_x_751 : Int | lq_tmp_x_751 /= 0} -&gt; Double</span><span class='hs-varop'>`divide`</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_758 : Int | lq_tmp_x_758 == sz#a2kZ}</span><span class='hs-varid'>sz</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_781 : (List Double) | lq_tmp_x_781 == p#a2kY}</span><span class='hs-varid'>p</span></a>
</pre>
<p><strong>Note:</strong> The code below uses <code>map</code> from <code>List.lhs</code>; and hence your solution will only work if you solved that problem first.</p>
<h2 id="e-iterative-clustering">(e) Iterative Clustering</h2>
<p>The Kmeans clustering algorithm is shown below:</p>
<pre><span class=hs-linenum>185: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>kmeans</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>186: </span>              <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span>
<span class=hs-linenum>187: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>188: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_3018:{v : Int | v &gt; 0} -&gt; lq_tmp_x_3019:{v : Int | v &gt; 0} -&gt; lq_tmp_x_3020:{v : Int | v &gt; 0} -&gt; lq_tmp_x_3021:(List {v : (List Double) | size v == lq_tmp_x_3020}) -&gt; lq_tmp_x_3022:(Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; lq_tmp_x_3019} {v : (List Double) | size v == lq_tmp_x_3020}) -&gt; (Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; lq_tmp_x_3019} {v : (List Double) | size v == lq_tmp_x_3020})</span><span class='hs-definition'>kmeans</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>steps</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(List {v : (List Double) | size v == n#a2l3})</span><span class='hs-varid'>ps</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2946:{VV#2929 : Int^"lq_tmp_x_2931" | $k__2930} -&gt; lq_tmp_x_2947:(lq_tmp_x_2945:{VV#2933 : a^"lq_tmp_x_2935" | $k__2934[ds_d2rp:=lq_tmp_x_2946]} -&gt; {VV#2936 : a^"lq_tmp_x_2938" | $k__2937[lq_tmp_x_2932:=lq_tmp_x_2945][ds_d2rp:=lq_tmp_x_2946]}) -&gt; lq_tmp_x_2948:{VV#2939 : a^"lq_tmp_x_2941" | $k__2940[ds_d2rp:=lq_tmp_x_2946][f#a2l5:=lq_tmp_x_2947]} -&gt; {VV#2942 : a^"lq_tmp_x_2944" | $k__2943[ds_d2rp:=lq_tmp_x_2946][f#a2l5:=lq_tmp_x_2947][x#a2l6:=lq_tmp_x_2948]}</span><span class='hs-varid'>repeat</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_3079 : Int | lq_tmp_x_3079 == steps#a2l1}</span><span class='hs-varid'>steps</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_3089:(Map {lq_tmp_x_3080 : Int | 0 &lt;= lq_tmp_x_3080 &amp;&amp; lq_tmp_x_3080 &lt; k#a2l2} {lq_tmp_x_3082 : (List Double) | size lq_tmp_x_3082 == n#a2l3}) -&gt; (Map {lq_tmp_x_3084 : Int | 0 &lt;= lq_tmp_x_3084 &amp;&amp; lq_tmp_x_3084 &lt; k#a2l2} {lq_tmp_x_3086 : (List Double) | size lq_tmp_x_3086 == n#a2l3})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_3044:{lq_tmp_x_3027 : Int | lq_tmp_x_3027 &gt; 0} -&gt; lq_tmp_x_3045:{lq_tmp_x_3028 : Int | lq_tmp_x_3028 &gt; 0} -&gt; lq_tmp_x_3046:(List {lq_tmp_x_3030 : (List Double) | size lq_tmp_x_3030 == lq_tmp_x_3045}) -&gt; lq_tmp_x_3047:(Map {lq_tmp_x_3032 : Int | 0 &lt;= lq_tmp_x_3032 &amp;&amp; lq_tmp_x_3032 &lt; lq_tmp_x_3044} {lq_tmp_x_3034 : (List Double) | size lq_tmp_x_3034 == lq_tmp_x_3045}) -&gt; (Map {lq_tmp_x_3036 : Int | 0 &lt;= lq_tmp_x_3036 &amp;&amp; lq_tmp_x_3036 &lt; lq_tmp_x_3044} {lq_tmp_x_3038 : (List Double) | size lq_tmp_x_3038 == lq_tmp_x_3045})</span><span class='hs-varid'>kmeans1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_3048 : Int | lq_tmp_x_3048 == k#a2l2}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_3049 : Int | lq_tmp_x_3049 == n#a2l3}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_3052 : (List {lq_tmp_x_3051 : (List Double) | size lq_tmp_x_3051 == n#a2l3}) | lq_tmp_x_3052 == ps#a2l4}</span><span class='hs-varid'>ps</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>189: </span>
<span class=hs-linenum>190: </span><span class='hs-definition'>repeat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>191: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_2946:{VV#2929 : Int^"lq_tmp_x_2931" | $k__2930} -&gt; lq_tmp_x_2947:(lq_tmp_x_2945:{VV#2933 : a^"lq_tmp_x_2935" | $k__2934[ds_d2rp:=lq_tmp_x_2946]} -&gt; {VV#2936 : a^"lq_tmp_x_2938" | $k__2937[lq_tmp_x_2932:=lq_tmp_x_2945][ds_d2rp:=lq_tmp_x_2946]}) -&gt; lq_tmp_x_2948:{VV#2939 : a^"lq_tmp_x_2941" | $k__2940[ds_d2rp:=lq_tmp_x_2946][f#a2l5:=lq_tmp_x_2947]} -&gt; {VV#2942 : a^"lq_tmp_x_2944" | $k__2943[ds_d2rp:=lq_tmp_x_2946][f#a2l5:=lq_tmp_x_2947][x#a2l6:=lq_tmp_x_2948]}</span><span class='hs-definition'>repeat</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2945:{VV : a^"lq_tmp_x_2935" | $k__2934[ds_d2rp:=ds_d2rp][VV#2933:=VV][lq_tmp_x_2946:=ds_d2rp]} -&gt; {VV : a^"lq_tmp_x_2938" | $k__2937[lq_tmp_x_2932:=lq_tmp_x_2945][ds_d2rp:=ds_d2rp][VV#2936:=VV][lq_tmp_x_2946:=ds_d2rp]}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp_x_2941" | $k__2940[ds_d2rp:=ds_d2rp][f#a2l5:=f#a2l5][VV#2939:=VV][lq_tmp_x_2946:=ds_d2rp][lq_tmp_x_2947:=f#a2l5]}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp_x_2941" | VV == x#a2l6}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>192: </span><span class='hs-definition'>repeat</span> <span class='hs-varid'>n</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2946:{VV#2929 : Int^"lq_tmp_x_2931" | $k__2930} -&gt; lq_tmp_x_2947:(lq_tmp_x_2945:{VV#2933 : a^"lq_tmp_x_2935" | $k__2934[ds_d2rp:=lq_tmp_x_2946]} -&gt; {VV#2936 : a^"lq_tmp_x_2938" | $k__2937[lq_tmp_x_2932:=lq_tmp_x_2945][ds_d2rp:=lq_tmp_x_2946]}) -&gt; lq_tmp_x_2948:{VV#2939 : a^"lq_tmp_x_2941" | $k__2940[ds_d2rp:=lq_tmp_x_2946][f#a2l5:=lq_tmp_x_2947]} -&gt; {VV#2942 : a^"lq_tmp_x_2944" | $k__2943[ds_d2rp:=lq_tmp_x_2946][f#a2l5:=lq_tmp_x_2947][x#a2l6:=lq_tmp_x_2948]}</span><span class='hs-varid'>repeat</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_3012 : Int^"lq_tmp_x_2990" | lq_tmp_x_3012 == lq_anf__d2sz}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2994 : Int^"lq_tmp_x_2931" | lq_tmp_x_2994 == ds_d2rp}</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_2988:Int -&gt; lq_tmp_x_2989:Int -&gt; {lq_tmp_x_2991 : Int^"lq_tmp_x_2990" | lq_tmp_x_2991 == lq_tmp_x_2988 - lq_tmp_x_2989}</span><span class='hs-comment'>-</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2995 : Int | lq_tmp_x_2995 == lq_anf__d2sy}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_3014:{VV : a^"lq_tmp_x_2935" | $k__2934[ds_d2rp:=ds_d2rp][VV#2933:=VV][lq_tmp_x_2946:=ds_d2rp]} -&gt; {VV : a^"lq_tmp_x_2938" | $k__2937[lq_tmp_x_2932:=lq_tmp_x_3014][ds_d2rp:=ds_d2rp][VV#2936:=VV][lq_tmp_x_2946:=ds_d2rp][lq_tmp_x_2945:=lq_tmp_x_3014]}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp_x_2938" | VV == lq_anf__d2sA}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_2998:{VV : a^"lq_tmp_x_2935" | $k__2934[ds_d2rp:=ds_d2rp][VV#2933:=VV][lq_tmp_x_2946:=ds_d2rp]} -&gt; {VV : a^"lq_tmp_x_2938" | $k__2937[lq_tmp_x_2932:=lq_tmp_x_2998][ds_d2rp:=ds_d2rp][VV#2936:=VV][lq_tmp_x_2946:=ds_d2rp][lq_tmp_x_2945:=lq_tmp_x_2998]}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp_x_2941" | VV == x#a2l6}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
</pre>
<p>In essence we start with an initial <code>k</code> centering, and repeatedly update it by calling <code>kmeans1</code> which takes as input a list of <code>n</code> dimensional points, a centering and returns a new centering (with <code>k</code> centers and <code>n</code> dimensional points). The new centers are computed by:</p>
<ol style="list-style-type: decimal">
<li>Mapping each point to its <code>nearest</code> center,</li>
<li>Grouping all the points mapped to a center into a new cluster,</li>
<li>Reducing the clusters by adding up all the points inside them, and</li>
<li>Normalizing each cluster to its <code>centroid</code>.</li>
</ol>
<pre><span class=hs-linenum>205: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>kmeans1</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>206: </span>               <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span>
<span class=hs-linenum>207: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>208: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_2266:{v : Int | v &gt; 0} -&gt; lq_tmp_x_2267:{v : Int | v &gt; 0} -&gt; lq_tmp_x_2268:(List {v : (List Double) | size v == lq_tmp_x_2267}) -&gt; lq_tmp_x_2269:(Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; lq_tmp_x_2266} {v : (List Double) | size v == lq_tmp_x_2267}) -&gt; (Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; lq_tmp_x_2266} {v : (List Double) | size v == lq_tmp_x_2267})</span><span class='hs-definition'>kmeans1</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt; 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(List {v : (List Double) | size v == n#a2lb})</span><span class='hs-varid'>ps</span></a> <a class=annot href="#"><span class=annottext>(Map {v : Int | 0 &lt;= v &amp;&amp; v &lt; k#a2la} {v : (List Double) | size v == n#a2lb})</span><span class='hs-varid'>cs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2914:{lq_tmp_x_2909 : (Map {VV#2736 : a^"lq_tmp_x_2738" | $k__2737[VV#2758:=lq_tmp_x_2909]} {lq_tmp_x_2908 : ({lq_tmp_x_2902 : Int^"lq_tmp_x_2741" | $k__2740[VV#2739:=lq_tmp_x_2902][VV#2755:=lq_tmp_x_2908][VV#2758:=lq_tmp_x_2909]}, {lq_tmp_x_2904 : (List {lq_tmp_x_2903 : Double^"lq_tmp_x_2744" | $k__2743[VV#2742:=lq_tmp_x_2903][VV#2745:=lq_tmp_x_2904][VV#2755:=lq_tmp_x_2908][VV#2758:=lq_tmp_x_2909]})^"lq_tmp_x_2747" | $k__2746[VV#2745:=lq_tmp_x_2904][VV#2755:=lq_tmp_x_2908][VV#2758:=lq_tmp_x_2909]})^"lq_tmp_x_2757" | $k__2756[VV#2755:=lq_tmp_x_2908][VV#2758:=lq_tmp_x_2909]})^"lq_tmp_x_2760" | $k__2759[VV#2758:=lq_tmp_x_2909]} -&gt; {lq_tmp_x_2912 : (Map {VV#2761 : a^"lq_tmp_x_2763" | $k__2762[VV#2770:=lq_tmp_x_2912][lq_tmp_x_2735:=lq_tmp_x_2914]} {lq_tmp_x_2911 : (List {lq_tmp_x_2910 : Double^"lq_tmp_x_2766" | $k__2765[VV#2764:=lq_tmp_x_2910][VV#2767:=lq_tmp_x_2911][VV#2770:=lq_tmp_x_2912][lq_tmp_x_2735:=lq_tmp_x_2914]})^"lq_tmp_x_2769" | $k__2768[VV#2767:=lq_tmp_x_2911][VV#2770:=lq_tmp_x_2912][lq_tmp_x_2735:=lq_tmp_x_2914]})^"lq_tmp_x_2772" | $k__2771[VV#2770:=lq_tmp_x_2912][lq_tmp_x_2735:=lq_tmp_x_2914]}</span><span class='hs-varid'>normalize</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2927 : (Map {lq_tmp_x_2919 : Int^"lq_tmp_x_2654" "lq_tmp_x_214" | $k__2653[VV#2652:=lq_tmp_x_2919][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc][lq_tmp_x_2655:=lq_tmp_x_2919][lq_tmp_x_2632:=lq_tmp_x_2927]} {lq_tmp_x_2926 : ({lq_tmp_x_2920 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2920][VV#2672:=lq_tmp_x_2926][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc][lq_tmp_x_2675:=lq_tmp_x_2920][lq_tmp_x_2681:=lq_tmp_x_2926][lq_tmp_x_2632:=lq_tmp_x_2927]}, {lq_tmp_x_2922 : (List {lq_tmp_x_2921 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2921][VV#2662:=lq_tmp_x_2922][VV#2672:=lq_tmp_x_2926][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc][lq_tmp_x_2676:=lq_tmp_x_2921][lq_tmp_x_2677:=lq_tmp_x_2922][lq_tmp_x_2681:=lq_tmp_x_2926][lq_tmp_x_2632:=lq_tmp_x_2927]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2922][VV#2672:=lq_tmp_x_2926][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc][lq_tmp_x_2677:=lq_tmp_x_2922][lq_tmp_x_2681:=lq_tmp_x_2926][lq_tmp_x_2632:=lq_tmp_x_2927]})^"lq_tmp_x_2674" "lq_tmp_x_215" | $k__2673[VV#2672:=lq_tmp_x_2926][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc][lq_tmp_x_2681:=lq_tmp_x_2926][lq_tmp_x_2632:=lq_tmp_x_2927]})^"lq_tmp_x_216" | lq_tmp_x_2927 == newClusters#a2lf}</span><span class='hs-varid'>newClusters</span></a>
<span class=hs-linenum>209: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>210: </span>    <span class='hs-varid'>normalize</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>211: </span>    <a class=annot href="#"><span class=annottext>lq_tmp_x_2735:{VV#2758 : (Map {VV#2736 : a^"lq_tmp_x_2738" | $k__2737} {VV#2755 : ({VV#2739 : Int^"lq_tmp_x_2741" | $k__2740}, {VV#2745 : (List {VV#2742 : Double^"lq_tmp_x_2744" | $k__2743})^"lq_tmp_x_2747" | $k__2746})^"lq_tmp_x_2757" | $k__2756})^"lq_tmp_x_2760" | $k__2759} -&gt; {VV#2770 : (Map {VV#2761 : a^"lq_tmp_x_2763" | $k__2762} {VV#2767 : (List {VV#2764 : Double^"lq_tmp_x_2766" | $k__2765})^"lq_tmp_x_2769" | $k__2768})^"lq_tmp_x_2772" | $k__2771}</span><span class='hs-varid'>normalize</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2900:{lq_tmp_x_2896 : ({lq_tmp_x_2890 : Int^"lq_tmp_x_2775" | $k__2774[VV#2773:=lq_tmp_x_2890][VV#2789:=lq_tmp_x_2896]}, {lq_tmp_x_2892 : (List {lq_tmp_x_2891 : Double^"lq_tmp_x_2778" | $k__2777[VV#2776:=lq_tmp_x_2891][VV#2779:=lq_tmp_x_2892][VV#2789:=lq_tmp_x_2896]})^"lq_tmp_x_2781" | $k__2780[VV#2779:=lq_tmp_x_2892][VV#2789:=lq_tmp_x_2896]})^"lq_tmp_x_2791" | $k__2790[VV#2789:=lq_tmp_x_2896]} -&gt; {lq_tmp_x_2898 : (List {lq_tmp_x_2897 : Double^"lq_tmp_x_2795" | $k__2794[VV#2793:=lq_tmp_x_2897][VV#2796:=lq_tmp_x_2898][ds_d2rv:=lq_tmp_x_2900]})^"lq_tmp_x_2798" | $k__2797[VV#2796:=lq_tmp_x_2898][ds_d2rv:=lq_tmp_x_2900]}</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>{VV#2796 : (List {VV#2793 : Double^"lq_tmp_x_2795" | $k__2794})^"lq_tmp_x_2798" | $k__2797}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>sz</span><span class='hs-layout'>,</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2837:{lq_tmp_x_2828 : Int | lq_tmp_x_2828 &gt;= 0} -&gt; lq_tmp_x_2838:{lq_tmp_x_2830 : (List Double) | size lq_tmp_x_2830 == lq_tmp_x_2837} -&gt; lq_tmp_x_2839:{lq_tmp_x_2831 : Int | lq_tmp_x_2831 &gt; 0} -&gt; {lq_tmp_x_2833 : (List Double) | size lq_tmp_x_2833 == lq_tmp_x_2837}</span><span class='hs-varid'>centroid</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2840 : Int | lq_tmp_x_2840 == n#a2lb}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2842 : (List {lq_tmp_x_2841 : Double^"lq_tmp_x_2778" "lq_tmp_x_2785" | $k__2777[VV#2776:=lq_tmp_x_2841][VV#2779:=lq_tmp_x_2842][VV#2789:=lq_anf__d2su][lq_tmp_x_2800:=lq_tmp_x_2841][lq_tmp_x_2801:=lq_tmp_x_2842][lq_tmp_x_2805:=lq_anf__d2su][lq_tmp_x_2813:=lq_anf__d2su][lq_tmp_x_2818:=sz#a2lj][lq_tmp_x_2808:=lq_tmp_x_2841][lq_tmp_x_2809:=lq_tmp_x_2842] &amp;&amp; $k__2784[VV#2783:=lq_tmp_x_2841][VV#2786:=lq_tmp_x_2812][lq_tmp_x_2782:=sz#a2lj][lq_tmp_x_2803:=lq_tmp_x_2841][lq_tmp_x_2804:=lq_tmp_x_2812][lq_tmp_x_2802:=sz#a2lj][lq_tmp_x_2810:=sz#a2lj][lq_tmp_x_2811:=lq_tmp_x_2841][lq_tmp_x_2818:=sz#a2lj][lq_tmp_x_2808:=lq_tmp_x_2841][lq_tmp_x_2809:=lq_tmp_x_2842]})^"lq_tmp_x_2781" "lq_tmp_x_2788" | lq_tmp_x_2842 == p#a2lk}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2843 : Int^"lq_tmp_x_2775" | lq_tmp_x_2843 == sz#a2lj}</span><span class='hs-varid'>sz</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>212: </span>    <a class=annot href="#"><span class=annottext>(Map {lq_tmp_x_2655 : Int^"lq_tmp_x_2654" "lq_tmp_x_214" | $k__2653[VV#2652:=lq_tmp_x_2655][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc]} {lq_tmp_x_2681 : ({lq_tmp_x_2675 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2675][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc]}, {lq_tmp_x_2677 : (List {lq_tmp_x_2676 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2676][VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc]})^"lq_tmp_x_2674" "lq_tmp_x_215" | $k__2673[VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS][lq_tmp_x_2641:=fm#a2lg][lq_tmp_x_2642:=fr#a2lh][lq_tmp_x_2643:=ps#a2lc]})</span><span class='hs-varid'>newClusters</span></a>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2641:(lq_tmp_x_2637:{lq_tmp_x_2651 : (List {lq_tmp_x_2650 : Double^"lq_tmp_x_2646" | $k__2645[VV#2644:=lq_tmp_x_2650][VV#2647:=lq_tmp_x_2651][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2649" "lq_tmp_x_199" | $k__2648[VV#2647:=lq_tmp_x_2651][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]} -&gt; (List ({lq_tmp_x_2655 : Int^"lq_tmp_x_2654" "lq_tmp_x_200" | $k__2653[VV#2652:=lq_tmp_x_2655][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2681 : ({lq_tmp_x_2675 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2675][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2677 : (List {lq_tmp_x_2676 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2676][VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2674" "lq_tmp_x_201" | $k__2673[VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}))) -&gt; lq_tmp_x_2642:(lq_tmp_x_2638:{lq_tmp_x_2681 : ({lq_tmp_x_2675 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2675][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2677 : (List {lq_tmp_x_2676 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2676][VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2674" "lq_tmp_x_207" | $k__2673[VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]} -&gt; lq_tmp_x_2639:{lq_tmp_x_2681 : ({lq_tmp_x_2675 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2675][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2677 : (List {lq_tmp_x_2676 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2676][VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2674" "lq_tmp_x_209" | $k__2673[VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]} -&gt; {lq_tmp_x_2681 : ({lq_tmp_x_2675 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2675][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2677 : (List {lq_tmp_x_2676 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2676][VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2674" "lq_tmp_x_210" | $k__2673[VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}) -&gt; lq_tmp_x_2643:(List {lq_tmp_x_2651 : (List {lq_tmp_x_2650 : Double^"lq_tmp_x_2646" | $k__2645[VV#2644:=lq_tmp_x_2650][VV#2647:=lq_tmp_x_2651][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2649" "lq_tmp_x_212" | $k__2648[VV#2647:=lq_tmp_x_2651][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}) -&gt; (Map {lq_tmp_x_2655 : Int^"lq_tmp_x_2654" "lq_tmp_x_214" | $k__2653[VV#2652:=lq_tmp_x_2655][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]} {lq_tmp_x_2681 : ({lq_tmp_x_2675 : Int^"lq_tmp_x_2658" | $k__2657[VV#2656:=lq_tmp_x_2675][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]}, {lq_tmp_x_2677 : (List {lq_tmp_x_2676 : Double^"lq_tmp_x_2661" | $k__2660[VV#2659:=lq_tmp_x_2676][VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2664" | $k__2663[VV#2662:=lq_tmp_x_2677][VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})^"lq_tmp_x_2674" "lq_tmp_x_215" | $k__2673[VV#2672:=lq_tmp_x_2681][lq_tmp_x_2640:=fix#GHC.Classes.#36#fOrdInt#35#rmS]})</span><span class='hs-varid'>mapReduce</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_2705:{lq_tmp_x_2685 : (List {lq_tmp_x_2684 : Double^"lq_tmp_x_2360" | $k__2359[VV#2358:=lq_tmp_x_2684][VV#2361:=lq_tmp_x_2685]})^"lq_tmp_x_2363" | $k__2362[VV#2361:=lq_tmp_x_2685]} -&gt; {lq_tmp_x_2703 : (List {lq_tmp_x_2702 : ({lq_tmp_x_2686 : Int^"lq_tmp_x_2367" | $k__2366[VV#2365:=lq_tmp_x_2686][VV#2407:=lq_tmp_x_2702][VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]}, {lq_tmp_x_2693 : ({lq_tmp_x_2687 : Int^"lq_tmp_x_2370" | $k__2369[VV#2368:=lq_tmp_x_2687][VV#2384:=lq_tmp_x_2693][VV#2407:=lq_tmp_x_2702][VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]}, {lq_tmp_x_2689 : (List {lq_tmp_x_2688 : Double^"lq_tmp_x_2373" | $k__2372[VV#2371:=lq_tmp_x_2688][VV#2374:=lq_tmp_x_2689][VV#2384:=lq_tmp_x_2693][VV#2407:=lq_tmp_x_2702][VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]})^"lq_tmp_x_2376" | $k__2375[VV#2374:=lq_tmp_x_2689][VV#2384:=lq_tmp_x_2693][VV#2407:=lq_tmp_x_2702][VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]})^"lq_tmp_x_2386" | $k__2385[VV#2384:=lq_tmp_x_2693][VV#2407:=lq_tmp_x_2702][VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]})^"lq_tmp_x_2409" | $k__2408[VV#2407:=lq_tmp_x_2702][VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]})^"lq_tmp_x_2412" | $k__2411[VV#2410:=lq_tmp_x_2703][p#a2ll:=lq_tmp_x_2705]}</span><span class='hs-varid'>fm</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_2729:{lq_tmp_x_2712 : ({lq_tmp_x_2706 : Int^"lq_tmp_x_2276" | $k__2275[VV#2274:=lq_tmp_x_2706][VV#2290:=lq_tmp_x_2712]}, {lq_tmp_x_2708 : (List {lq_tmp_x_2707 : Double^"lq_tmp_x_2279" | $k__2278[VV#2277:=lq_tmp_x_2707][VV#2280:=lq_tmp_x_2708][VV#2290:=lq_tmp_x_2712]})^"lq_tmp_x_2282" | $k__2281[VV#2280:=lq_tmp_x_2708][VV#2290:=lq_tmp_x_2712]})^"lq_tmp_x_2292" | $k__2291[VV#2290:=lq_tmp_x_2712]} -&gt; lq_tmp_x_2730:{lq_tmp_x_2719 : ({lq_tmp_x_2713 : Int^"lq_tmp_x_2296" | $k__2295[VV#2294:=lq_tmp_x_2713][VV#2310:=lq_tmp_x_2719][wp1#a2lm:=lq_tmp_x_2729]}, {lq_tmp_x_2715 : (List {lq_tmp_x_2714 : Double^"lq_tmp_x_2299" | $k__2298[VV#2297:=lq_tmp_x_2714][VV#2300:=lq_tmp_x_2715][VV#2310:=lq_tmp_x_2719][wp1#a2lm:=lq_tmp_x_2729]})^"lq_tmp_x_2302" | $k__2301[VV#2300:=lq_tmp_x_2715][VV#2310:=lq_tmp_x_2719][wp1#a2lm:=lq_tmp_x_2729]})^"lq_tmp_x_2312" | $k__2311[VV#2310:=lq_tmp_x_2719][wp1#a2lm:=lq_tmp_x_2729]} -&gt; ({lq_tmp_x_2720 : Int | lq_tmp_x_2720 &gt; 0}, {lq_tmp_x_2722 : (List Double) | size lq_tmp_x_2722 == n#a2lb})</span><span class='hs-varid'>fr</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2733 : (List {lq_tmp_x_2732 : (List Double) | size lq_tmp_x_2732 == n#a2lb}) | lq_tmp_x_2733 == ps#a2lc}</span><span class='hs-varid'>ps</span></a>
<span class=hs-linenum>213: </span>    <a class=annot href="#"><span class=annottext>p#a2ll:{VV#2361 : (List {VV#2358 : Double^"lq_tmp_x_2360" | $k__2359})^"lq_tmp_x_2363" | $k__2362} -&gt; {VV#2410 : (List {VV#2407 : ({VV#2365 : Int^"lq_tmp_x_2367" | $k__2366}, {VV#2384 : ({VV#2368 : Int^"lq_tmp_x_2370" | $k__2369}, {VV#2374 : (List {VV#2371 : Double^"lq_tmp_x_2373" | $k__2372})^"lq_tmp_x_2376" | $k__2375})^"lq_tmp_x_2386" | $k__2385})^"lq_tmp_x_2409" | $k__2408})^"lq_tmp_x_2412" | $k__2411}</span><span class='hs-varid'>fm</span></a> <a class=annot href="#"><span class=annottext>{VV#2361 : (List {VV#2358 : Double^"lq_tmp_x_2360" | $k__2359})^"lq_tmp_x_2363" | $k__2362}</span><span class='hs-varid'>p</span></a>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2543:a -&gt; {lq_tmp_x_2541 : (List a) | size lq_tmp_x_2541 == 1}</span><span class='hs-varid'>singleton</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2622 : ({lq_tmp_x_2606 : Int^"lq_tmp_x_2483" | $k__2482[VV#2481:=lq_tmp_x_2606][lq_tmp_x_2479:=lq_anf__d2sq][lq_tmp_x_2480:=lq_anf__d2ss][lq_tmp_x_2484:=lq_tmp_x_2606][lq_tmp_x_2476:=lq_tmp_x_2622]}, {lq_tmp_x_2613 : ({lq_tmp_x_2607 : Int^"lq_tmp_x_2487" | $k__2486[VV#2485:=lq_tmp_x_2607][VV#2501:=lq_tmp_x_2613][lq_tmp_x_2479:=lq_anf__d2sq][lq_tmp_x_2480:=lq_anf__d2ss][lq_tmp_x_2504:=lq_tmp_x_2607][lq_tmp_x_2510:=lq_tmp_x_2613][lq_tmp_x_2476:=lq_tmp_x_2622]}, {lq_tmp_x_2609 : (List {lq_tmp_x_2608 : Double^"lq_tmp_x_2490" | $k__2489[VV#2488:=lq_tmp_x_2608][VV#2491:=lq_tmp_x_2609][VV#2501:=lq_tmp_x_2613][lq_tmp_x_2479:=lq_anf__d2sq][lq_tmp_x_2480:=lq_anf__d2ss][lq_tmp_x_2505:=lq_tmp_x_2608][lq_tmp_x_2506:=lq_tmp_x_2609][lq_tmp_x_2510:=lq_tmp_x_2613][lq_tmp_x_2476:=lq_tmp_x_2622]})^"lq_tmp_x_2493" | $k__2492[VV#2491:=lq_tmp_x_2609][VV#2501:=lq_tmp_x_2613][lq_tmp_x_2479:=lq_anf__d2sq][lq_tmp_x_2480:=lq_anf__d2ss][lq_tmp_x_2506:=lq_tmp_x_2609][lq_tmp_x_2510:=lq_tmp_x_2613][lq_tmp_x_2476:=lq_tmp_x_2622]})^"lq_tmp_x_2503" | $k__2502[VV#2501:=lq_tmp_x_2613][lq_tmp_x_2479:=lq_anf__d2sq][lq_tmp_x_2480:=lq_anf__d2ss][lq_tmp_x_2510:=lq_tmp_x_2613][lq_tmp_x_2476:=lq_tmp_x_2622]}) | lq_tmp_x_2622 == lq_anf__d2st}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_2426:{lq_tmp_x_2413 : Int | lq_tmp_x_2413 &gt; 0} -&gt; lq_tmp_x_2427:{lq_tmp_x_2414 : Int | lq_tmp_x_2414 &gt; 0} -&gt; lq_tmp_x_2428:(Map {lq_tmp_x_2415 : Int | 0 &lt;= lq_tmp_x_2415 &amp;&amp; lq_tmp_x_2415 &lt; lq_tmp_x_2426} {lq_tmp_x_2417 : (List Double) | size lq_tmp_x_2417 == lq_tmp_x_2427}) -&gt; lq_tmp_x_2429:{lq_tmp_x_2420 : (List Double) | size lq_tmp_x_2420 == lq_tmp_x_2427} -&gt; {lq_tmp_x_2421 : Int | 0 &lt;= lq_tmp_x_2421 &amp;&amp; lq_tmp_x_2421 &lt; lq_tmp_x_2426}</span><span class='hs-varid'>nearest</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2430 : Int | lq_tmp_x_2430 == k#a2la}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2431 : Int | lq_tmp_x_2431 == n#a2lb}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2435 : (Map {lq_tmp_x_2432 : Int | 0 &lt;= lq_tmp_x_2432 &amp;&amp; lq_tmp_x_2432 &lt; k#a2la} {lq_tmp_x_2434 : (List Double) | size lq_tmp_x_2434 == n#a2lb}) | lq_tmp_x_2435 == cs#a2ld}</span><span class='hs-varid'>cs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2437 : (List {lq_tmp_x_2436 : Double^"lq_tmp_x_2360" | $k__2359[VV#2358:=lq_tmp_x_2436][VV#2361:=lq_tmp_x_2437]})^"lq_tmp_x_2363" | lq_tmp_x_2437 == p#a2ll}</span><span class='hs-varid'>p</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2539 : ({lq_tmp_x_2533 : Int^"lq_tmp_x_2453" | $k__2452[VV#2451:=lq_tmp_x_2533][lq_tmp_x_2449:=lq_anf__d2sr][lq_tmp_x_2450:=p#a2ll][lq_tmp_x_2454:=lq_tmp_x_2533][lq_tmp_x_2446:=lq_tmp_x_2539]}, {lq_tmp_x_2535 : (List {lq_tmp_x_2534 : Double^"lq_tmp_x_2457" | $k__2456[VV#2455:=lq_tmp_x_2534][VV#2458:=lq_tmp_x_2535][lq_tmp_x_2449:=lq_anf__d2sr][lq_tmp_x_2450:=p#a2ll][lq_tmp_x_2461:=lq_tmp_x_2534][lq_tmp_x_2462:=lq_tmp_x_2535][lq_tmp_x_2446:=lq_tmp_x_2539]})^"lq_tmp_x_2460" | $k__2459[VV#2458:=lq_tmp_x_2535][lq_tmp_x_2449:=lq_anf__d2sr][lq_tmp_x_2450:=p#a2ll][lq_tmp_x_2462:=lq_tmp_x_2535][lq_tmp_x_2446:=lq_tmp_x_2539]}) | lq_tmp_x_2539 == lq_anf__d2ss}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2471 : Int | lq_tmp_x_2471 == lq_anf__d2sr}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2473 : (List {lq_tmp_x_2472 : Double^"lq_tmp_x_2360" | $k__2359[VV#2358:=lq_tmp_x_2472][VV#2361:=lq_tmp_x_2473]})^"lq_tmp_x_2363" | lq_tmp_x_2473 == p#a2ll}</span><span class='hs-varid'>p</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>214: </span>    <a class=annot href="#"><span class=annottext>wp1#a2lm:{VV#2290 : ({VV#2274 : Int^"lq_tmp_x_2276" | $k__2275}, {VV#2280 : (List {VV#2277 : Double^"lq_tmp_x_2279" | $k__2278})^"lq_tmp_x_2282" | $k__2281})^"lq_tmp_x_2292" | $k__2291} -&gt; wp2#a2ln:{VV#2310 : ({VV#2294 : Int^"lq_tmp_x_2296" | $k__2295}, {VV#2300 : (List {VV#2297 : Double^"lq_tmp_x_2299" | $k__2298})^"lq_tmp_x_2302" | $k__2301})^"lq_tmp_x_2312" | $k__2311} -&gt; ({lq_tmp_x_2329 : Int | lq_tmp_x_2329 &gt; 0}, {lq_tmp_x_2331 : (List Double) | size lq_tmp_x_2331 == n#a2lb})</span><span class='hs-varid'>fr</span></a> <a class=annot href="#"><span class=annottext>{VV#2290 : ({VV#2274 : Int^"lq_tmp_x_2276" | $k__2275}, {VV#2280 : (List {VV#2277 : Double^"lq_tmp_x_2279" | $k__2278})^"lq_tmp_x_2282" | $k__2281})^"lq_tmp_x_2292" | $k__2291}</span><span class='hs-varid'>wp1</span></a> <a class=annot href="#"><span class=annottext>{VV#2310 : ({VV#2294 : Int^"lq_tmp_x_2296" | $k__2295}, {VV#2300 : (List {VV#2297 : Double^"lq_tmp_x_2299" | $k__2298})^"lq_tmp_x_2302" | $k__2301})^"lq_tmp_x_2312" | $k__2311}</span><span class='hs-varid'>wp2</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2339:{lq_tmp_x_2314 : Int | lq_tmp_x_2314 &gt;= 0} -&gt; lq_tmp_x_2340:({lq_tmp_x_2315 : Int | lq_tmp_x_2315 &gt; 0}, {lq_tmp_x_2317 : (List Double) | size lq_tmp_x_2317 == lq_tmp_x_2339}) -&gt; lq_tmp_x_2341:({lq_tmp_x_2322 : Int | lq_tmp_x_2322 &gt; 0}, {lq_tmp_x_2324 : (List Double) | size lq_tmp_x_2324 == lq_tmp_x_2339}) -&gt; ({lq_tmp_x_2329 : Int | lq_tmp_x_2329 &gt; 0}, {lq_tmp_x_2331 : (List Double) | size lq_tmp_x_2331 == lq_tmp_x_2339})</span><span class='hs-varid'>mergeCluster</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2342 : Int | lq_tmp_x_2342 == n#a2lb}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2349 : ({lq_tmp_x_2343 : Int^"lq_tmp_x_2276" | $k__2275[VV#2274:=lq_tmp_x_2343][VV#2290:=lq_tmp_x_2349]}, {lq_tmp_x_2345 : (List {lq_tmp_x_2344 : Double^"lq_tmp_x_2279" | $k__2278[VV#2277:=lq_tmp_x_2344][VV#2280:=lq_tmp_x_2345][VV#2290:=lq_tmp_x_2349]})^"lq_tmp_x_2282" | $k__2281[VV#2280:=lq_tmp_x_2345][VV#2290:=lq_tmp_x_2349]})^"lq_tmp_x_2292" | lq_tmp_x_2349 == wp1#a2lm}</span><span class='hs-varid'>wp1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2356 : ({lq_tmp_x_2350 : Int^"lq_tmp_x_2296" | $k__2295[VV#2294:=lq_tmp_x_2350][VV#2310:=lq_tmp_x_2356]}, {lq_tmp_x_2352 : (List {lq_tmp_x_2351 : Double^"lq_tmp_x_2299" | $k__2298[VV#2297:=lq_tmp_x_2351][VV#2300:=lq_tmp_x_2352][VV#2310:=lq_tmp_x_2356]})^"lq_tmp_x_2302" | $k__2301[VV#2300:=lq_tmp_x_2352][VV#2310:=lq_tmp_x_2356]})^"lq_tmp_x_2312" | lq_tmp_x_2356 == wp2#a2ln}</span><span class='hs-varid'>wp2</span></a>
</pre>
<p>Fix the code and specifications above so that LH verifies the the specification for <code>kmeans</code> and <code>kmeans1</code> (i.e. verifies this entire module.)</p>
<p><strong>Hint:</strong> If you did the above problems correctly, you should have to do nothing here. Otherwise, think about what type <code>normalize</code> should have and try to work backwards to verify that type.</p>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>
