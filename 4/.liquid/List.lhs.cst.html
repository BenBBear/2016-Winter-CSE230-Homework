<h1 id="lists">Lists</h1>
<div class="hidden">

<pre><span class=hs-linenum> 7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 9: </span>
<span class=hs-linenum>10: </span><span class='hs-comment'>-- CHECKBINDER prop_size</span>
<span class=hs-linenum>11: </span><span class='hs-comment'>-- CHECKBINDER empty</span>
<span class=hs-linenum>12: </span><span class='hs-comment'>-- CHECKBINDER add</span>
<span class=hs-linenum>13: </span><span class='hs-comment'>-- CHECKBINDER singleton</span>
<span class=hs-linenum>14: </span><span class='hs-comment'>-- CHECKBINDER prop_replicate</span>
<span class=hs-linenum>15: </span><span class='hs-comment'>-- CHECKBINDER prop_map</span>
<span class=hs-linenum>16: </span><span class='hs-comment'>-- CHECKBINDER foldr1</span>
<span class=hs-linenum>17: </span><span class='hs-comment'>-- CHECKBINDER prop_zipWith</span>
<span class=hs-linenum>18: </span><span class='hs-comment'>-- CHECKBINDER prop_concat</span>
<span class=hs-linenum>19: </span> 
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span> <span class='hs-conid'>List</span>
<span class=hs-linenum>22: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>empty</span>
<span class=hs-linenum>23: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>add</span>
<span class=hs-linenum>24: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>singleton</span>
<span class=hs-linenum>25: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>map</span>
<span class=hs-linenum>26: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>replicate</span>
<span class=hs-linenum>27: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span>
<span class=hs-linenum>28: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>foldr1</span>
<span class=hs-linenum>29: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span>
<span class=hs-linenum>30: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>concat</span>
<span class=hs-linenum>31: </span>            <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>32: </span>
<span class=hs-linenum>33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Assert</span>
<span class=hs-linenum>34: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span><span class='hs-layout'>,</span> <span class='hs-varid'>replicate</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr1</span><span class='hs-layout'>,</span> <span class='hs-varid'>map</span><span class='hs-layout'>,</span> <span class='hs-varid'>concat</span><span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span><span class='hs-layout'>)</span>
<span class=hs-linenum>35: </span>
<span class=hs-linenum>36: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>9</span> <span class='hs-conop'>:+:</span>
<span class=hs-linenum>37: </span>
<span class=hs-linenum>38: </span><span class='hs-definition'>empty</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>39: </span><span class='hs-definition'>add</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>40: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>41: </span><span class='hs-definition'>replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>42: </span><span class='hs-definition'>map</span>       <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>43: </span><span class='hs-definition'>zipWith</span>   <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>44: </span><span class='hs-definition'>concat</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
</pre>
<h2 id="a-sized-list-datatype">A Sized List Datatype</h2>
<p>Lets cook up our own <code>List</code> data type from scratch:</p>
<pre><span class=hs-linenum>53: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>54: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conop'>:+:</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>55: </span>              <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Eq a) =&gt; (Eq (List a))</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Eq (List a), Ord a) =&gt; (Ord (List a))</span><span class='hs-conid'>Ord</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Show a) =&gt; (Show (List a))</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>)</span>
</pre>
<p>We can write a <strong>measure</strong> that logically represents the <em>size</em>, i.e. number of elements of a <code>List</code>:</p>
<pre><span class=hs-linenum>62: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>size</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>63: </span>    <span class='hs-varid'>size</span> <span class='hs-layout'>(</span><span class='hs-conid'>Emp</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>64: </span>    <span class='hs-varid'>size</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conop'>:+:</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>size</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>65: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>66: </span>
<span class=hs-linenum>67: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>invariant</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt;= size v}</span> <span class='hs-keyword'>@-}</span>
</pre>
<p>It will be helpful to have a few abbreviations. First, lists whose size is equal to <code>N</code></p>
<pre><span class=hs-linenum>74: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>
<p>and then, lists whose size equals that of <em>another</em> list <code>Xs</code>:</p>
<pre><span class=hs-linenum>79: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span> <span class='hs-conid'>Xs</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>
<h2 id="a-computing-the-length-of-a-list">(a) Computing the Length of a List</h2>
<p>Write down a <em>refined</em> type for <code>length</code>:</p>
<pre><span class=hs-linenum>88: </span><span class='hs-comment'>-- size is only defined for List, not ListN or ListX, so that is why you get unbound symbol error</span>
<span class=hs-linenum>89: </span><span class='hs-comment'>-- at first</span>
<span class=hs-linenum>90: </span>
<span class=hs-linenum>91: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>length</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>lst</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>Int</span> <span class='hs-keyword'>| v == size(lst)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>92: </span><span class='hs-definition'>length</span>            <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>93: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1723:(List a) -&gt; {v : Int | v == size lq_tmp_x_1723}</span><span class='hs-definition'>length</span></a> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1736:Int# -&gt; {lq_tmp_x_1734 : Int | lq_tmp_x_1734 == (lq_tmp_x_1736 : int)}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>94: </span><span class='hs-definition'>length</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1779 : Int | lq_tmp_x_1779 == lq_anf__d1HS}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1773:Int -&gt; lq_tmp_x_1774:Int -&gt; {lq_tmp_x_1776 : Int^"lq_tmp_x_1775" | lq_tmp_x_1776 == lq_tmp_x_1773 + lq_tmp_x_1774}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1780 : Int | lq_tmp_x_1780 == lq_anf__d1HT}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1766 : (List a) | lq_tmp_x_1766 == xs#a1uH}</span><span class='hs-varid'>xs</span></a>
</pre>
<p>such that the following type checks:</p>
<pre><span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>102: </span><a class=annot href="#"><span class=annottext>{v : Bool | Prop v}</span><span class='hs-definition'>prop_size</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1818:{lq_tmp_x_1815 : Bool | Prop lq_tmp_x_1815} -&gt; {lq_tmp_x_1816 : Bool | Prop lq_tmp_x_1816}</span><span class='hs-varid'>lAssert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1819 : Bool | lq_tmp_x_1819 == lq_anf__d1HW}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1812 : Int | lq_tmp_x_1812 == lq_anf__d1HU}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1790 : (List Int) | lq_tmp_x_1790 == List.l3#rXs}</span><span class='hs-varid'>l3</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1804:{lq_tmp_x_1809 : Int^"lq_tmp_x_1808" | $k__1807[VV#1806:=lq_tmp_x_1809][lq_tmp_x_1803:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; lq_tmp_x_1805:{lq_tmp_x_1809 : Int^"lq_tmp_x_1808" | $k__1807[VV#1806:=lq_tmp_x_1809][lq_tmp_x_1803:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; {lq_tmp_x_1799 : Bool | Prop lq_tmp_x_1799 &lt;=&gt; lq_tmp_x_1804 == lq_tmp_x_1805}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1813 : Int | lq_tmp_x_1813 == lq_anf__d1HV}</span><span class='hs-num'>3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>3</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>105: </span><a class=annot href="#"><span class=annottext>{v : (List Int) | size v == 3}</span><span class='hs-definition'>l3</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1719 : Int | lq_tmp_x_1719 == lq_anf__d1HQ}</span><span class='hs-num'>3</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1721 : (List Int) | lq_tmp_x_1721 == List.l2#rXt}</span><span class='hs-varid'>l2</span></a>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>108: </span><a class=annot href="#"><span class=annottext>{v : (List Int) | size v == 2}</span><span class='hs-definition'>l2</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1699 : Int | lq_tmp_x_1699 == lq_anf__d1HP}</span><span class='hs-num'>2</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1701 : (List Int) | lq_tmp_x_1701 == List.l1#rXu}</span><span class='hs-varid'>l1</span></a>
<span class=hs-linenum>109: </span>
<span class=hs-linenum>110: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>111: </span><a class=annot href="#"><span class=annottext>{v : (List Int) | size v == 1}</span><span class='hs-definition'>l1</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1679 : Int | lq_tmp_x_1679 == lq_anf__d1HO}</span><span class='hs-num'>1</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1681 : (List Int) | lq_tmp_x_1681 == List.l0#rXv}</span><span class='hs-varid'>l0</span></a>
<span class=hs-linenum>112: </span>
<span class=hs-linenum>113: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l0</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>114: </span><a class=annot href="#"><span class=annottext>{v : (List Int) | size v == 0}</span><span class='hs-definition'>l0</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Int</span>
</pre>
<h2 id="b-constructing-lists">(b) Constructing Lists</h2>
<p>Fill in the implementations of the following functions so that LiquidHaskell verifies respect the given type signatures:</p>
<pre><span class=hs-linenum>125: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>126: </span><a class=annot href="#"><span class=annottext>{v : (List a) | size v == 0}</span><span class='hs-definition'>empty</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>add</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{1 + size xs}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>129: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1573:a -&gt; lq_tmp_x_1574:(List a) -&gt; {v : (List a) | size v == 1 + size lq_tmp_x_1574}</span><span class='hs-definition'>add</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1uI}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1586 : (List a) | lq_tmp_x_1586 == xs#a1uJ}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>130: </span>
<span class=hs-linenum>131: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>132: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1588:a -&gt; {v : (List a) | size v == 1}</span><span class='hs-definition'>singleton</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1600:(List {VV#1601 : a^"lq_tmp_x_1603" | $k__1602[lq_tmp_x_1599:=x#a1uK]}) -&gt; {lq_tmp_x_1596 : (List {VV#1601 : a^"lq_tmp_x_1603" | $k__1602[lq_tmp_x_1599:=x#a1uK]}) | size lq_tmp_x_1596 == 1 + size lq_tmp_x_1600}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1uK}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1590 : (List a) | allSize lq_tmp_x_1590 == 0 &amp;&amp; size lq_tmp_x_1590 == 0}</span><span class='hs-conid'>Emp</span></a>
</pre>
<h2 id="c-replicating-values">(c) Replicating Values</h2>
<p>Fill in the code, and update the refinement type specification for <code>replicate n x</code> which should return a <code>List</code> <code>n</code> copies of the value <code>x</code>:</p>
<pre><span class=hs-linenum>143: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>144: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1606:Int -&gt; lq_tmp_x_1607:a -&gt; {v : (List a) | size v == lq_tmp_x_1606}</span><span class='hs-definition'>replicate</span></a>  <a class=annot href="#"><span class=annottext>Int</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1647:(List {VV#1648 : a^"lq_tmp_x_1650" | $k__1649[lq_tmp_x_1646:=a#a1uM]}) -&gt; {lq_tmp_x_1643 : (List {VV#1648 : a^"lq_tmp_x_1650" | $k__1649[lq_tmp_x_1646:=a#a1uM]}) | size lq_tmp_x_1643 == 1 + size lq_tmp_x_1647}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == a#a1uM}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1651 : (List {VV#1637 : a^"lq_tmp_x_1639" | $k__1638[lq_tmp_x_1635:=lq_anf__d1HM][lq_tmp_x_1636:=a#a1uM][lq_tmp_x_1632:=lq_tmp_x_1651]}) | lq_tmp_x_1651 == lq_anf__d1HN}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1606:Int -&gt; lq_tmp_x_1607:a -&gt; {v : (List a) | size v == lq_tmp_x_1606}</span><span class='hs-varid'>replicate</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1640 : Int^"lq_tmp_x_1624" | lq_tmp_x_1640 == lq_anf__d1HM}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1628 : Int | lq_tmp_x_1628 == n#a1uL}</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1622:Int -&gt; lq_tmp_x_1623:Int -&gt; {lq_tmp_x_1625 : Int^"lq_tmp_x_1624" | lq_tmp_x_1625 == lq_tmp_x_1622 - lq_tmp_x_1623}</span><span class='hs-comment'>-</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1629 : Int | lq_tmp_x_1629 == lq_anf__d1HL}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == a#a1uM}</span><span class='hs-varid'>a</span></a><span class='hs-layout'>)</span>
</pre>
<p>When you are done, the following assertion should be verified by LH.</p>
<pre><span class=hs-linenum>150: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>151: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1821:{v : Int | v &gt;= 0} -&gt; lq_tmp_x_1822:a -&gt; {v : Bool | Prop v}</span><span class='hs-definition'>prop_replicate</span></a> <a class=annot href="#"><span class=annottext>{v : Int | v &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1865:{lq_tmp_x_1862 : Bool | Prop lq_tmp_x_1862} -&gt; {lq_tmp_x_1863 : Bool | Prop lq_tmp_x_1863}</span><span class='hs-varid'>lAssert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1866 : Bool | lq_tmp_x_1866 == lq_anf__d1HZ}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1859 : Int | lq_tmp_x_1859 == n#a1uN}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1851:{lq_tmp_x_1856 : Int^"lq_tmp_x_1855" | $k__1854[VV#1853:=lq_tmp_x_1856][lq_tmp_x_1850:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; lq_tmp_x_1852:{lq_tmp_x_1856 : Int^"lq_tmp_x_1855" | $k__1854[VV#1853:=lq_tmp_x_1856][lq_tmp_x_1850:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; {lq_tmp_x_1846 : Bool | Prop lq_tmp_x_1846 &lt;=&gt; lq_tmp_x_1851 == lq_tmp_x_1852}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1860 : Int | lq_tmp_x_1860 == lq_anf__d1HY}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1843 : (List {VV#1831 : a^"lq_tmp_x_1833" | $k__1832[lq_tmp_x_1829:=n#a1uN][lq_tmp_x_1830:=x#a1uO][lq_tmp_x_1826:=lq_tmp_x_1843]}) | lq_tmp_x_1843 == lq_anf__d1HX}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1606:Int -&gt; lq_tmp_x_1607:a -&gt; {v : (List a) | size v == lq_tmp_x_1606}</span><span class='hs-varid'>replicate</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1834 : Int | lq_tmp_x_1834 == n#a1uN}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1uO}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
</pre>
<h2 id="d-map">(d) Map</h2>
<p>Fix the specification for <code>map</code> such that the assertion in <code>prop_map</code> is verified by LH. (This will require you to first complete part (a) above.)</p>
<pre><span class=hs-linenum>161: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>map</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>lst</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>{size lst}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>162: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1511:(lq_tmp_x_1510:a -&gt; b) -&gt; lq_tmp_x_1512:(List a) -&gt; {v : (List b) | size v == size lq_tmp_x_1512}</span><span class='hs-definition'>map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1510:a -&gt; b</span><span class='hs-varid'>f</span></a> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1523 : (List a) | allSize lq_tmp_x_1523 == 0 &amp;&amp; size lq_tmp_x_1523 == 0}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>163: </span><span class='hs-definition'>map</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1543:a -&gt; b</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1uR}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1511:(lq_tmp_x_1510:a -&gt; b) -&gt; lq_tmp_x_1512:(List a) -&gt; {v : (List b) | size v == size lq_tmp_x_1512}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1560:a -&gt; b</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1561 : (List a) | lq_tmp_x_1561 == xs#a1uS}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>164: </span>
<span class=hs-linenum>165: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_map</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>166: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1869:(lq_tmp_x_1868:a -&gt; a) -&gt; lq_tmp_x_1870:(List a) -&gt; {v : Bool | Prop v}</span><span class='hs-definition'>prop_map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1868:a -&gt; a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1929:{lq_tmp_x_1926 : Bool | Prop lq_tmp_x_1926} -&gt; {lq_tmp_x_1927 : Bool | Prop lq_tmp_x_1927}</span><span class='hs-varid'>lAssert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1930 : Bool | lq_tmp_x_1930 == lq_anf__d1I3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_1923 : Int | lq_tmp_x_1923 == lq_anf__d1I0}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1880 : (List a) | lq_tmp_x_1880 == xs#a1uU}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1915:{lq_tmp_x_1920 : Int^"lq_tmp_x_1919" | $k__1918[VV#1917:=lq_tmp_x_1920][lq_tmp_x_1914:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; lq_tmp_x_1916:{lq_tmp_x_1920 : Int^"lq_tmp_x_1919" | $k__1918[VV#1917:=lq_tmp_x_1920][lq_tmp_x_1914:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; {lq_tmp_x_1910 : Bool | Prop lq_tmp_x_1910 &lt;=&gt; lq_tmp_x_1915 == lq_tmp_x_1916}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1924 : Int | lq_tmp_x_1924 == lq_anf__d1I2}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1907 : (List {VV#1893 : a^"lq_tmp_x_1895" | $k__1894[lq_tmp_x_1888:=f#a1uT][lq_tmp_x_1889:=xs#a1uU][lq_tmp_x_1884:=lq_tmp_x_1907]}) | lq_tmp_x_1907 == lq_anf__d1I1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1511:(lq_tmp_x_1510:a -&gt; b) -&gt; lq_tmp_x_1512:(List a) -&gt; {v : (List b) | size v == size lq_tmp_x_1512}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1897:a -&gt; a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1898 : (List a) | lq_tmp_x_1898 == xs#a1uU}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
</pre>
<h2 id="e-fold">(e) Fold</h2>
<p>Fix the specification for <code>foldr1</code> so that the call to <code>die</code> is verified by LH:</p>
<pre><span class=hs-linenum>176: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>foldr1</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size v &gt; 0}</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>177: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1437:(lq_tmp_x_1435:a -&gt; lq_tmp_x_1436:a -&gt; a) -&gt; lq_tmp_x_1438:{v : (List a) | size v &gt; 0} -&gt; a</span><span class='hs-definition'>foldr1</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1435:a -&gt; lq_tmp_x_1436:a -&gt; a</span><span class='hs-varid'>op</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1379:(lq_tmp_x_1377:a -&gt; lq_tmp_x_1378:b -&gt; b) -&gt; lq_tmp_x_1380:b -&gt; lq_tmp_x_1381:(List a) -&gt; b</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1506:a -&gt; lq_tmp_x_1507:a -&gt; a</span><span class='hs-varid'>op</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1uW}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1508 : (List a) | lq_tmp_x_1508 == xs#a1uX}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>178: </span><span class='hs-definition'>foldr1</span> <span class='hs-varid'>op</span> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1464:{lq_tmp_x_1462 : [Char] | false} -&gt; t</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1471 : [Char] | lq_tmp_x_1471 == lq_anf__d1HG}</span><span class='hs-str'>"Cannot call foldr1 with empty list"</span></a>
<span class=hs-linenum>179: </span>
<span class=hs-linenum>180: </span>
<span class=hs-linenum>181: </span><span class='hs-definition'>foldr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>182: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1379:(lq_tmp_x_1377:a -&gt; lq_tmp_x_1378:b -&gt; b) -&gt; lq_tmp_x_1380:b -&gt; lq_tmp_x_1381:(List a) -&gt; b</span><span class='hs-definition'>foldr</span></a> <span class='hs-keyword'>_</span>  <a class=annot href="#"><span class=annottext>b</span><span class='hs-varid'>b</span></a> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : b^"lq_tmp_x_585" | VV == b#a1uZ}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>183: </span><span class='hs-definition'>foldr</span> <span class='hs-varid'>op</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp_x_587" | VV == x#a1v2}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1433:a -&gt; lq_tmp_x_1434:b -&gt; b</span><span class='hs-varop'>`op`</span></a> <a class=annot href="#"><span class=annottext>{VV#1422 : b^"lq_tmp_x_1424" "lq_tmp_x_589" | VV#1422 == lq_anf__d1HD}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>lq_tmp_x_1379:(lq_tmp_x_1377:a -&gt; lq_tmp_x_1378:b -&gt; b) -&gt; lq_tmp_x_1380:b -&gt; lq_tmp_x_1381:(List a) -&gt; b</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1427:a -&gt; lq_tmp_x_1428:b -&gt; b</span><span class='hs-varid'>op</span></a> <a class=annot href="#"><span class=annottext>{VV : b^"lq_tmp_x_585" | VV == b#a1uZ}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1429 : (List a) | lq_tmp_x_1429 == xs#a1v3}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
</pre>
<h2 id="f-zipwith">(f) ZipWith</h2>
<p>Fix the specification of <code>zipWith</code> so that LH verifies:</p>
<ul>
<li>The call to <code>die</code> inside <code>zipWith</code> and</li>
<li>The assert inside <code>prop_zipwith</code>.</li>
</ul>
<pre><span class=hs-linenum>195: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>zipWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>l1</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>{size l1}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>{size l1}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>196: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1200:(lq_tmp_x_1198:a -&gt; lq_tmp_x_1199:b -&gt; c) -&gt; lq_tmp_x_1201:(List a) -&gt; lq_tmp_x_1202:{v : (List b) | size v == size lq_tmp_x_1201} -&gt; {v : (List c) | size v == size lq_tmp_x_1201}</span><span class='hs-definition'>zipWith</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>Emp</span> <span class='hs-conid'>Emp</span>               <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1221 : (List a) | allSize lq_tmp_x_1221 == 0 &amp;&amp; size lq_tmp_x_1221 == 0}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>197: </span><span class='hs-definition'>zipWith</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1335:a -&gt; lq_tmp_x_1336:b -&gt; c</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1v5}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV : b | VV == y#a1v7}</span><span class='hs-varid'>y</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1200:(lq_tmp_x_1198:a -&gt; lq_tmp_x_1199:b -&gt; c) -&gt; lq_tmp_x_1201:(List a) -&gt; lq_tmp_x_1202:{v : (List b) | size v == size lq_tmp_x_1201} -&gt; {v : (List c) | size v == size lq_tmp_x_1201}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1362:a -&gt; lq_tmp_x_1363:b -&gt; c</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1364 : (List a) | lq_tmp_x_1364 == xs#a1v6}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1365 : (List b) | lq_tmp_x_1365 == ys#a1v8}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum>198: </span><span class='hs-definition'>zipWith</span> <span class='hs-varid'>f</span> <span class='hs-keyword'>_</span>          <span class='hs-keyword'>_</span>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1306:{lq_tmp_x_1304 : [Char] | false} -&gt; t</span><span class='hs-varid'>die</span></a>  <a class=annot href="#"><span class=annottext>{lq_tmp_x_1317 : [Char] | lq_tmp_x_1317 == lq_anf__d1Hz}</span><span class='hs-str'>"Bad call to zipWith"</span></a>
<span class=hs-linenum>199: </span>
<span class=hs-linenum>200: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_zipWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>201: </span><a class=annot href="#"><span class=annottext>(Num a) =&gt; lq_tmp_x_1933:(List a) -&gt; {v : Bool | Prop v}</span><span class='hs-definition'>prop_zipWith</span></a> <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2013:{lq_tmp_x_2010 : Bool | Prop lq_tmp_x_2010} -&gt; {lq_tmp_x_2011 : Bool | Prop lq_tmp_x_2011}</span><span class='hs-varid'>lAssert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2014 : Bool | lq_tmp_x_2014 == lq_anf__d1I7}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2007 : Int | lq_tmp_x_2007 == lq_anf__d1I5}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1982 : (List a) | lq_tmp_x_1982 == xs#a1va}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1999:{lq_tmp_x_2004 : Int^"lq_tmp_x_2003" | $k__2002[VV#2001:=lq_tmp_x_2004][lq_tmp_x_1998:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; lq_tmp_x_2000:{lq_tmp_x_2004 : Int^"lq_tmp_x_2003" | $k__2002[VV#2001:=lq_tmp_x_2004][lq_tmp_x_1998:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; {lq_tmp_x_1994 : Bool | Prop lq_tmp_x_1994 &lt;=&gt; lq_tmp_x_1999 == lq_tmp_x_2000}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2008 : Int | lq_tmp_x_2008 == lq_anf__d1I6}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1991 : (List {VV#1965 : a^"lq_tmp_x_1967" | $k__1966[lq_tmp_x_1956:=lq_anf__d1I4][lq_tmp_x_1957:=xs#a1va][lq_tmp_x_1958:=xs#a1va][lq_tmp_x_1950:=lq_tmp_x_1991]}) | lq_tmp_x_1991 == x2s#a1vb}</span><span class='hs-varid'>x2s</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>202: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>203: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_1950 : (List {VV#1965 : a^"lq_tmp_x_1967" | $k__1966[lq_tmp_x_1956:=lq_anf__d1I4][lq_tmp_x_1957:=xs#a1va][lq_tmp_x_1958:=xs#a1va]}) | size lq_tmp_x_1950 == size xs#a1va}</span><span class='hs-varid'>x2s</span></a>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_1200:(lq_tmp_x_1198:a -&gt; lq_tmp_x_1199:b -&gt; c) -&gt; lq_tmp_x_1201:(List a) -&gt; lq_tmp_x_1202:{v : (List b) | size v == size lq_tmp_x_1201} -&gt; {v : (List c) | size v == size lq_tmp_x_1201}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>lq_tmp_x_1970:a -&gt; lq_tmp_x_1971:a -&gt; {VV : a^"lq_tmp_x_1943" | VV == lq_tmp_x_1970 + lq_tmp_x_1971}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1972 : (List a) | lq_tmp_x_1972 == xs#a1va}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1973 : (List a) | lq_tmp_x_1973 == xs#a1va}</span><span class='hs-varid'>xs</span></a>
</pre>
<h2 id="g-list-concatenation-hard">(g) List Concatenation <em>(Hard?)</em></h2>
<p>Fill in the (refinement type) specification and implementation for the function <code>concat</code> such that when you are done, the assert inside <code>prop_concat</code> is verified by LH. Feel free to write any other code or specification (types, measures) that you need.</p>
<pre><span class=hs-linenum>216: </span>
<span class=hs-linenum>217: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>allSize</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>218: </span>    <span class='hs-varid'>allSize</span> <span class='hs-layout'>(</span><span class='hs-conid'>Emp</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>219: </span>    <span class='hs-varid'>allSize</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conop'>:+:</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-varid'>allSize</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>220: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>221: </span>
<span class=hs-linenum>222: </span>
<span class=hs-linenum>223: </span>
<span class=hs-linenum>224: </span>
<span class=hs-linenum>225: </span>
<span class=hs-linenum>226: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>concat'</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l1</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>l2</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size l1 + size l2}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>227: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_970:(List a) -&gt; lq_tmp_x_971:(List a) -&gt; {v : (List a) | size v == size lq_tmp_x_970 + size lq_tmp_x_971}</span><span class='hs-definition'>concat'</span></a> <span class='hs-conid'>Emp</span> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_989 : (List a) | allSize lq_tmp_x_989 == 0 &amp;&amp; size lq_tmp_x_989 == 0}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>228: </span><span class='hs-definition'>concat'</span> <span class='hs-conid'>Emp</span> <span class='hs-varid'>l2</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1012 : (List a) | lq_tmp_x_1012 == ds_d1FY}</span><span class='hs-varid'>l2</span></a>
<span class=hs-linenum>229: </span><span class='hs-definition'>concat'</span> <span class='hs-varid'>l1</span> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1046 : (List a) | lq_tmp_x_1046 == ds_d1FX}</span><span class='hs-varid'>l1</span></a>
<span class=hs-linenum>230: </span><span class='hs-definition'>concat'</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varid'>l2</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_970:(List a) -&gt; lq_tmp_x_971:(List a) -&gt; {v : (List a) | size v == size lq_tmp_x_970 + size lq_tmp_x_971}</span><span class='hs-varid'>concat'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1139 : (List a) | lq_tmp_x_1139 == xs#a1vf}</span><span class='hs-varid'>xs</span></a>  <a class=annot href="#"><span class=annottext>{lq_tmp_x_1140 : (List {VV#1124 : a^"lq_tmp_x_1126" | $k__1125[lq_tmp_x_1122:=x#a1ve][lq_tmp_x_1123:=ds_d1FY][lq_tmp_x_1119:=lq_tmp_x_1140]}) | lq_tmp_x_1140 == lq_anf__d1Hh}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == x#a1ve}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1127 : (List a) | lq_tmp_x_1127 == ds_d1FY}</span><span class='hs-varid'>l2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>231: </span>
<span class=hs-linenum>232: </span>
<span class=hs-linenum>233: </span>
<span class=hs-linenum>234: </span>
<span class=hs-linenum>235: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>concat</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>lst</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size(v) == allSize(lst)}</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>236: </span><a class=annot href="#"><span class=annottext>lq_tmp_x_1143:(List (List a)) -&gt; {v : (List a) | size v == allSize lq_tmp_x_1143}</span><span class='hs-definition'>concat</span></a> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1155 : (List a) | allSize lq_tmp_x_1155 == 0 &amp;&amp; size lq_tmp_x_1155 == 0}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>237: </span><span class='hs-definition'>concat</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_970:(List a) -&gt; lq_tmp_x_971:(List a) -&gt; {v : (List a) | size v == size lq_tmp_x_970 + size lq_tmp_x_971}</span><span class='hs-varid'>concat'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1196 : (List a) | lq_tmp_x_1196 == x#a1vh}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1197 : (List {VV#1180 : a^"lq_tmp_x_1182" | $k__1181[lq_tmp_x_1179:=xs#a1vi][lq_tmp_x_1177:=lq_tmp_x_1197]}) | lq_tmp_x_1197 == lq_anf__d1Hq}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>concat</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_1184 : (List (List a)) | lq_tmp_x_1184 == xs#a1vi}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>238: </span>
<span class=hs-linenum>239: </span><a class=annot href="#"><span class=annottext>{VV#2016 : Bool^"lq_tmp_x_2018" | $k__2017}</span><span class='hs-definition'>prop_concat</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2159:{lq_tmp_x_2156 : Bool | Prop lq_tmp_x_2156} -&gt; {lq_tmp_x_2157 : Bool | Prop lq_tmp_x_2157}</span><span class='hs-varid'>lAssert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2160 : Bool | lq_tmp_x_2160 == lq_anf__d1If}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp_x_2153 : Int | lq_tmp_x_2153 == lq_anf__d1Id}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2131 : (List {lq_tmp_x_2130 : Int^"lq_tmp_x_2116" | $k__2115[VV#2114:=lq_tmp_x_2130][lq_tmp_x_2113:=xss#a1vj][lq_tmp_x_2117:=lq_tmp_x_2130][lq_tmp_x_2111:=lq_tmp_x_2131]}) | lq_tmp_x_2131 == lq_anf__d1Ic}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>concat</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2120 : (List {lq_tmp_x_2119 : (List {lq_tmp_x_2118 : Int^"lq_tmp_x_2097" | $k__2096[VV#2095:=lq_tmp_x_2118][VV#2098:=lq_tmp_x_2119][lq_tmp_x_2093:=List.l0#rXv][lq_tmp_x_2094:=lq_anf__d1Ib][lq_tmp_x_2101:=lq_tmp_x_2118][lq_tmp_x_2102:=lq_tmp_x_2119][lq_tmp_x_2090:=lq_tmp_x_2120]})^"lq_tmp_x_2100" | $k__2099[VV#2098:=lq_tmp_x_2119][lq_tmp_x_2093:=List.l0#rXv][lq_tmp_x_2094:=lq_anf__d1Ib][lq_tmp_x_2102:=lq_tmp_x_2119][lq_tmp_x_2090:=lq_tmp_x_2120]}) | lq_tmp_x_2120 == xss#a1vj}</span><span class='hs-varid'>xss</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp_x_2145:{lq_tmp_x_2150 : Int^"lq_tmp_x_2149" | $k__2148[VV#2147:=lq_tmp_x_2150][lq_tmp_x_2144:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; lq_tmp_x_2146:{lq_tmp_x_2150 : Int^"lq_tmp_x_2149" | $k__2148[VV#2147:=lq_tmp_x_2150][lq_tmp_x_2144:=fix#GHC.Classes.#36#fEqInt#35#roe]} -&gt; {lq_tmp_x_2140 : Bool | Prop lq_tmp_x_2140 &lt;=&gt; lq_tmp_x_2145 == lq_tmp_x_2146}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2154 : Int | lq_tmp_x_2154 == lq_anf__d1Ie}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>240: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>241: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp_x_2090 : (List {lq_tmp_x_2102 : (List {lq_tmp_x_2101 : Int^"lq_tmp_x_2097" | $k__2096[VV#2095:=lq_tmp_x_2101][VV#2098:=lq_tmp_x_2102][lq_tmp_x_2093:=List.l0#rXv][lq_tmp_x_2094:=lq_anf__d1Ib]})^"lq_tmp_x_2100" | $k__2099[VV#2098:=lq_tmp_x_2102][lq_tmp_x_2093:=List.l0#rXv][lq_tmp_x_2094:=lq_anf__d1Ib]}) | allSize lq_tmp_x_2090 == size List.l0#rXv + allSize lq_anf__d1Ib &amp;&amp; size lq_tmp_x_2090 == 1 + size lq_anf__d1Ib}</span><span class='hs-varid'>xss</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2104 : (List Int) | lq_tmp_x_2104 == List.l0#rXv}</span><span class='hs-varid'>l0</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2084 : (List Int) | lq_tmp_x_2084 == List.l1#rXu}</span><span class='hs-varid'>l1</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2064 : (List Int) | lq_tmp_x_2064 == List.l2#rXt}</span><span class='hs-varid'>l2</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2044 : (List Int) | lq_tmp_x_2044 == List.l3#rXs}</span><span class='hs-varid'>l3</span></a> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>{lq_tmp_x_2019 : (List a) | allSize lq_tmp_x_2019 == 0 &amp;&amp; size lq_tmp_x_2019 == 0}</span><span class='hs-conid'>Emp</span></a>
</pre>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>
